TakeOrderedAndProject [profit,channel,returns,sales,id]
  WholeStageCodegen
    HashAggregate [sum,spark_grouping_id,sum,sum,sum(profit),channel,sum(sales),sum(returns),id] [sum,profit,sum,sum,sum(profit),returns,sum(sales),sum(returns),sales]
      InputAdapter
        Exchange [channel,id,spark_grouping_id] #1
          WholeStageCodegen
            HashAggregate [sum,spark_grouping_id,profit,sum,sum,channel,sum,sum,id,sum,sales,returns] [sum,sum,sum,sum,sum,sum]
              Expand [id,channel,profit,sales,returns]
                InputAdapter
                  Union
                    WholeStageCodegen
                      Project [profit,s_store_sk,profit_loss,returns,sales]
                        BroadcastHashJoin [s_store_sk,s_store_sk]
                          HashAggregate [sum,s_store_sk,sum(UnscaledValue(ss_net_profit)),sum,sum(UnscaledValue(ss_ext_sales_price))] [sum,sum(UnscaledValue(ss_net_profit)),profit,sum,sales,sum(UnscaledValue(ss_ext_sales_price))]
                            InputAdapter
                              Exchange [s_store_sk] #2
                                WholeStageCodegen
                                  HashAggregate [sum,sum,sum,s_store_sk,ss_net_profit,sum,ss_ext_sales_price] [sum,sum,sum,sum]
                                    Project [ss_ext_sales_price,ss_net_profit,s_store_sk]
                                      BroadcastHashJoin [ss_store_sk,s_store_sk]
                                        Project [ss_store_sk,ss_ext_sales_price,ss_net_profit]
                                          BroadcastHashJoin [ss_sold_date_sk,d_date_sk]
                                            Project [ss_sold_date_sk,ss_store_sk,ss_ext_sales_price,ss_net_profit]
                                              Filter [ss_sold_date_sk,ss_store_sk]
                                                Scan parquet default.store_sales [ss_sold_date_sk,ss_store_sk,ss_ext_sales_price,ss_net_profit] [ss_sold_date_sk,ss_store_sk,ss_ext_sales_price,ss_net_profit]
                                            InputAdapter
                                              BroadcastExchange #3
                                                WholeStageCodegen
                                                  Project [d_date_sk]
                                                    Filter [d_date,d_date_sk]
                                                      Scan parquet default.date_dim [d_date_sk,d_date] [d_date_sk,d_date]
                                        InputAdapter
                                          BroadcastExchange #4
                                            WholeStageCodegen
                                              Project [s_store_sk]
                                                Filter [s_store_sk]
                                                  Scan parquet default.store [s_store_sk] [s_store_sk]
                          InputAdapter
                            BroadcastExchange #5
                              WholeStageCodegen
                                HashAggregate [sum,sum(UnscaledValue(sr_return_amt)),sum(UnscaledValue(sr_net_loss)),sum,s_store_sk] [profit_loss,sum,sum(UnscaledValue(sr_return_amt)),sum(UnscaledValue(sr_net_loss)),sum,returns]
                                  InputAdapter
                                    Exchange [s_store_sk] #6
                                      WholeStageCodegen
                                        HashAggregate [sum,sr_return_amt,sum,sum,sr_net_loss,sum,s_store_sk] [sum,sum,sum,sum]
                                          Project [sr_return_amt,sr_net_loss,s_store_sk]
                                            BroadcastHashJoin [sr_store_sk,s_store_sk]
                                              Project [sr_store_sk,sr_return_amt,sr_net_loss]
                                                BroadcastHashJoin [sr_returned_date_sk,d_date_sk]
                                                  Project [sr_returned_date_sk,sr_store_sk,sr_return_amt,sr_net_loss]
                                                    Filter [sr_returned_date_sk,sr_store_sk]
                                                      Scan parquet default.store_returns [sr_returned_date_sk,sr_store_sk,sr_return_amt,sr_net_loss] [sr_returned_date_sk,sr_store_sk,sr_return_amt,sr_net_loss]
                                                  InputAdapter
                                                    BroadcastExchange #7
                                                      WholeStageCodegen
                                                        Project [d_date_sk]
                                                          Filter [d_date,d_date_sk]
                                                            Scan parquet default.date_dim [d_date_sk,d_date] [d_date_sk,d_date]
                                              InputAdapter
                                                BroadcastExchange #8
                                                  WholeStageCodegen
                                                    Project [s_store_sk]
                                                      Filter [s_store_sk]
                                                        Scan parquet default.store [s_store_sk] [s_store_sk]
                    WholeStageCodegen
                      Project [profit,profit_loss,sales,cs_call_center_sk,returns]
                        InputAdapter
                          BroadcastNestedLoopJoin
                            BroadcastExchange #9
                              WholeStageCodegen
                                HashAggregate [sum(UnscaledValue(cs_ext_sales_price)),sum,cs_call_center_sk,sum,sum(UnscaledValue(cs_net_profit))] [sum(UnscaledValue(cs_ext_sales_price)),profit,sum,sum,sum(UnscaledValue(cs_net_profit)),sales]
                                  InputAdapter
                                    Exchange [cs_call_center_sk] #10
                                      WholeStageCodegen
                                        HashAggregate [sum,cs_net_profit,sum,cs_ext_sales_price,cs_call_center_sk,sum,sum] [sum,sum,sum,sum]
                                          Project [cs_call_center_sk,cs_ext_sales_price,cs_net_profit]
                                            BroadcastHashJoin [cs_sold_date_sk,d_date_sk]
                                              Project [cs_sold_date_sk,cs_call_center_sk,cs_ext_sales_price,cs_net_profit]
                                                Filter [cs_sold_date_sk]
                                                  Scan parquet default.catalog_sales [cs_sold_date_sk,cs_call_center_sk,cs_ext_sales_price,cs_net_profit] [cs_sold_date_sk,cs_call_center_sk,cs_ext_sales_price,cs_net_profit]
                                              InputAdapter
                                                ReusedExchange [d_date_sk] [d_date_sk] #3
                            WholeStageCodegen
                              HashAggregate [sum,sum,sum(UnscaledValue(cr_return_amount)),sum(UnscaledValue(cr_net_loss))] [sum(UnscaledValue(cr_return_amount)),sum,returns,sum(UnscaledValue(cr_net_loss)),sum,profit_loss]
                                InputAdapter
                                  Exchange #11
                                    WholeStageCodegen
                                      HashAggregate [sum,sum,sum,cr_net_loss,cr_return_amount,sum] [sum,sum,sum,sum]
                                        Project [cr_return_amount,cr_net_loss]
                                          BroadcastHashJoin [cr_returned_date_sk,d_date_sk]
                                            Project [cr_returned_date_sk,cr_return_amount,cr_net_loss]
                                              Filter [cr_returned_date_sk]
                                                Scan parquet default.catalog_returns [cr_returned_date_sk,cr_return_amount,cr_net_loss] [cr_returned_date_sk,cr_return_amount,cr_net_loss]
                                            InputAdapter
                                              ReusedExchange [d_date_sk] [d_date_sk] #3
                    WholeStageCodegen
                      Project [profit,profit_loss,sales,wp_web_page_sk,returns]
                        BroadcastHashJoin [wp_web_page_sk,wp_web_page_sk]
                          HashAggregate [sum,wp_web_page_sk,sum,sum(UnscaledValue(ws_ext_sales_price)),sum(UnscaledValue(ws_net_profit))] [sum,sum,sales,sum(UnscaledValue(ws_ext_sales_price)),profit,sum(UnscaledValue(ws_net_profit))]
                            InputAdapter
                              Exchange [wp_web_page_sk] #12
                                WholeStageCodegen
                                  HashAggregate [sum,sum,wp_web_page_sk,sum,ws_net_profit,sum,ws_ext_sales_price] [sum,sum,sum,sum]
                                    Project [ws_ext_sales_price,ws_net_profit,wp_web_page_sk]
                                      BroadcastHashJoin [ws_web_page_sk,wp_web_page_sk]
                                        Project [ws_web_page_sk,ws_ext_sales_price,ws_net_profit]
                                          BroadcastHashJoin [ws_sold_date_sk,d_date_sk]
                                            Project [ws_sold_date_sk,ws_web_page_sk,ws_ext_sales_price,ws_net_profit]
                                              Filter [ws_sold_date_sk,ws_web_page_sk]
                                                Scan parquet default.web_sales [ws_sold_date_sk,ws_web_page_sk,ws_ext_sales_price,ws_net_profit] [ws_sold_date_sk,ws_web_page_sk,ws_ext_sales_price,ws_net_profit]
                                            InputAdapter
                                              ReusedExchange [d_date_sk] [d_date_sk] #3
                                        InputAdapter
                                          BroadcastExchange #13
                                            WholeStageCodegen
                                              Project [wp_web_page_sk]
                                                Filter [wp_web_page_sk]
                                                  Scan parquet default.web_page [wp_web_page_sk] [wp_web_page_sk]
                          InputAdapter
                            BroadcastExchange #14
                              WholeStageCodegen
                                HashAggregate [sum(UnscaledValue(wr_net_loss)),sum,sum(UnscaledValue(wr_return_amt)),wp_web_page_sk,sum] [sum(UnscaledValue(wr_net_loss)),profit_loss,sum,sum(UnscaledValue(wr_return_amt)),sum,returns]
                                  InputAdapter
                                    Exchange [wp_web_page_sk] #15
                                      WholeStageCodegen
                                        HashAggregate [sum,sum,wr_net_loss,wp_web_page_sk,sum,sum,wr_return_amt] [sum,sum,sum,sum]
                                          Project [wr_return_amt,wr_net_loss,wp_web_page_sk]
                                            BroadcastHashJoin [wr_web_page_sk,wp_web_page_sk]
                                              Project [wr_web_page_sk,wr_return_amt,wr_net_loss]
                                                BroadcastHashJoin [wr_returned_date_sk,d_date_sk]
                                                  Project [wr_returned_date_sk,wr_web_page_sk,wr_return_amt,wr_net_loss]
                                                    Filter [wr_returned_date_sk,wr_web_page_sk]
                                                      Scan parquet default.web_returns [wr_returned_date_sk,wr_web_page_sk,wr_return_amt,wr_net_loss] [wr_returned_date_sk,wr_web_page_sk,wr_return_amt,wr_net_loss]
                                                  InputAdapter
                                                    ReusedExchange [d_date_sk] [d_date_sk] #7
                                              InputAdapter
                                                BroadcastExchange #16
                                                  WholeStageCodegen
                                                    Project [wp_web_page_sk]
                                                      Filter [wp_web_page_sk]
                                                        Scan parquet default.web_page [wp_web_page_sk] [wp_web_page_sk]
