TakeOrderedAndProject [d_date,item_sk,store_cumulative,store_sales,web_cumulative,web_sales]
  WholeStageCodegen
    Filter [store_cumulative,web_cumulative]
      InputAdapter
        Window [d_date,item_sk,store_sales,web_sales]
          WholeStageCodegen
            Sort [d_date,item_sk]
              InputAdapter
                Exchange [item_sk] #1
                  WholeStageCodegen
                    Project [cume_sales,cume_sales,d_date,d_date,item_sk,item_sk]
                      InputAdapter
                        SortMergeJoin [d_date,d_date,item_sk,item_sk]
                          WholeStageCodegen
                            Sort [d_date,item_sk]
                              InputAdapter
                                Exchange [d_date,item_sk] #2
                                  WholeStageCodegen
                                    Project [cume_sales,d_date,item_sk]
                                      InputAdapter
                                        Window [_w0,d_date,ws_item_sk]
                                          WholeStageCodegen
                                            Sort [d_date,ws_item_sk]
                                              InputAdapter
                                                Exchange [ws_item_sk] #3
                                                  WholeStageCodegen
                                                    HashAggregate [d_date,sum,sum(UnscaledValue(ws_sales_price)),ws_item_sk] [_w0,item_sk,sum,sum(UnscaledValue(ws_sales_price))]
                                                      InputAdapter
                                                        Exchange [d_date,ws_item_sk] #4
                                                          WholeStageCodegen
                                                            HashAggregate [d_date,sum,sum,ws_item_sk,ws_sales_price] [sum,sum]
                                                              Project [d_date,ws_item_sk,ws_sales_price]
                                                                BroadcastHashJoin [d_date_sk,ws_sold_date_sk]
                                                                  Project [ws_item_sk,ws_sales_price,ws_sold_date_sk]
                                                                    Filter [ws_item_sk,ws_sold_date_sk]
                                                                      Scan parquet default.web_sales [ws_item_sk,ws_sales_price,ws_sold_date_sk] [ws_item_sk,ws_sales_price,ws_sold_date_sk]
                                                                  InputAdapter
                                                                    BroadcastExchange #5
                                                                      WholeStageCodegen
                                                                        Project [d_date,d_date_sk]
                                                                          Filter [d_date_sk,d_month_seq]
                                                                            Scan parquet default.date_dim [d_date,d_date_sk,d_month_seq] [d_date,d_date_sk,d_month_seq]
                          WholeStageCodegen
                            Sort [d_date,item_sk]
                              InputAdapter
                                Exchange [d_date,item_sk] #6
                                  WholeStageCodegen
                                    Project [cume_sales,d_date,item_sk]
                                      InputAdapter
                                        Window [_w0,d_date,ss_item_sk]
                                          WholeStageCodegen
                                            Sort [d_date,ss_item_sk]
                                              InputAdapter
                                                Exchange [ss_item_sk] #7
                                                  WholeStageCodegen
                                                    HashAggregate [d_date,ss_item_sk,sum,sum(UnscaledValue(ss_sales_price))] [_w0,item_sk,sum,sum(UnscaledValue(ss_sales_price))]
                                                      InputAdapter
                                                        Exchange [d_date,ss_item_sk] #8
                                                          WholeStageCodegen
                                                            HashAggregate [d_date,ss_item_sk,ss_sales_price,sum,sum] [sum,sum]
                                                              Project [d_date,ss_item_sk,ss_sales_price]
                                                                BroadcastHashJoin [d_date_sk,ss_sold_date_sk]
                                                                  Project [ss_item_sk,ss_sales_price,ss_sold_date_sk]
                                                                    Filter [ss_item_sk,ss_sold_date_sk]
                                                                      Scan parquet default.store_sales [ss_item_sk,ss_sales_price,ss_sold_date_sk] [ss_item_sk,ss_sales_price,ss_sold_date_sk]
                                                                  InputAdapter
                                                                    ReusedExchange [d_date,d_date_sk] [d_date,d_date_sk] #5
