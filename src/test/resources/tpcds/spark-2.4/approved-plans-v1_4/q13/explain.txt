== Physical Plan ==
*(7) HashAggregate(keys=[], functions=[avg(cast(ss_quantity#1 as bigint)), avg(UnscaledValue(ss_ext_sales_price#2)), avg(UnscaledValue(ss_ext_wholesale_cost#3)), sum(UnscaledValue(ss_ext_wholesale_cost#3))])
+- Exchange SinglePartition
   +- *(6) HashAggregate(keys=[], functions=[partial_avg(cast(ss_quantity#1 as bigint)), partial_avg(UnscaledValue(ss_ext_sales_price#2)), partial_avg(UnscaledValue(ss_ext_wholesale_cost#3)), partial_sum(UnscaledValue(ss_ext_wholesale_cost#3))])
      +- *(6) Project [ss_quantity#1, ss_ext_sales_price#2, ss_ext_wholesale_cost#3]
         +- *(6) BroadcastHashJoin [ss_hdemo_sk#4], [hd_demo_sk#5], Inner, BuildRight, (((((((cd_marital_status#6 = M) && (cd_education_status#7 = Advanced Degree)) && (ss_sales_price#8 >= 100.00)) && (ss_sales_price#8 <= 150.00)) && (hd_dep_count#9 = 3)) || (((((cd_marital_status#6 = S) && (cd_education_status#7 = College)) && (ss_sales_price#8 >= 50.00)) && (ss_sales_price#8 <= 100.00)) && (hd_dep_count#9 = 1))) || (((((cd_marital_status#6 = W) && (cd_education_status#7 = 2 yr Degree)) && (ss_sales_price#8 >= 150.00)) && (ss_sales_price#8 <= 200.00)) && (hd_dep_count#9 = 1)))
            :- *(6) Project [ss_hdemo_sk#4, ss_quantity#1, ss_sales_price#8, ss_ext_sales_price#2, ss_ext_wholesale_cost#3, cd_marital_status#6, cd_education_status#7]
            :  +- *(6) BroadcastHashJoin [ss_cdemo_sk#10], [cd_demo_sk#11], Inner, BuildRight
            :     :- *(6) Project [ss_cdemo_sk#10, ss_hdemo_sk#4, ss_quantity#1, ss_sales_price#8, ss_ext_sales_price#2, ss_ext_wholesale_cost#3]
            :     :  +- *(6) BroadcastHashJoin [ss_sold_date_sk#12], [d_date_sk#13], Inner, BuildRight
            :     :     :- *(6) Project [ss_sold_date_sk#12, ss_cdemo_sk#10, ss_hdemo_sk#4, ss_quantity#1, ss_sales_price#8, ss_ext_sales_price#2, ss_ext_wholesale_cost#3]
            :     :     :  +- *(6) BroadcastHashJoin [ss_addr_sk#14], [ca_address_sk#15], Inner, BuildRight, ((((ca_state#16 IN (TX,OH) && (ss_net_profit#17 >= 100.00)) && (ss_net_profit#17 <= 200.00)) || ((ca_state#16 IN (OR,NM,KY) && (ss_net_profit#17 >= 150.00)) && (ss_net_profit#17 <= 300.00))) || ((ca_state#16 IN (VA,TX,MS) && (ss_net_profit#17 >= 50.00)) && (ss_net_profit#17 <= 250.00)))
            :     :     :     :- *(6) Project [ss_sold_date_sk#12, ss_cdemo_sk#10, ss_hdemo_sk#4, ss_addr_sk#14, ss_quantity#1, ss_sales_price#8, ss_ext_sales_price#2, ss_ext_wholesale_cost#3, ss_net_profit#17]
            :     :     :     :  +- *(6) BroadcastHashJoin [ss_store_sk#18], [s_store_sk#19], Inner, BuildRight
            :     :     :     :     :- *(6) Project [ss_sold_date_sk#12, ss_cdemo_sk#10, ss_hdemo_sk#4, ss_addr_sk#14, ss_store_sk#18, ss_quantity#1, ss_sales_price#8, ss_ext_sales_price#2, ss_ext_wholesale_cost#3, ss_net_profit#17]
            :     :     :     :     :  +- *(6) Filter ((((isnotnull(ss_store_sk#18) && isnotnull(ss_addr_sk#14)) && isnotnull(ss_sold_date_sk#12)) && isnotnull(ss_cdemo_sk#10)) && isnotnull(ss_hdemo_sk#4))
            :     :     :     :     :     +- *(6) FileScan parquet default.store_sales[ss_sold_date_sk#12,ss_cdemo_sk#10,ss_hdemo_sk#4,ss_addr_sk#14,ss_store_sk#18,ss_quantity#1,ss_sales_price#8,ss_ext_sales_price#2,ss_ext_wholesale_cost#3,ss_net_profit#17] Batched: true, Format: Parquet, Location [not included in comparison]/{warehouse_dir}/store_sales], PartitionFilters: [], PushedFilters: [IsNotNull(ss_store_sk), IsNotNull(ss_addr_sk), IsNotNull(ss_sold_date_sk), IsNotNull(ss_cdemo_sk..., ReadSchema: struct<ss_sold_date_sk:int,ss_cdemo_sk:int,ss_hdemo_sk:int,ss_addr_sk:int,ss_store_sk:int,ss_quan...
            :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)))
            :     :     :     :        +- *(1) Project [s_store_sk#19]
            :     :     :     :           +- *(1) Filter isnotnull(s_store_sk#19)
            :     :     :     :              +- *(1) FileScan parquet default.store[s_store_sk#19] Batched: true, Format: Parquet, Location [not included in comparison]/{warehouse_dir}/store], PartitionFilters: [], PushedFilters: [IsNotNull(s_store_sk)], ReadSchema: struct<s_store_sk:int>
            :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)))
            :     :     :        +- *(2) Project [ca_address_sk#15, ca_state#16]
            :     :     :           +- *(2) Filter ((isnotnull(ca_country#20) && (ca_country#20 = United States)) && isnotnull(ca_address_sk#15))
            :     :     :              +- *(2) FileScan parquet default.customer_address[ca_address_sk#15,ca_state#16,ca_country#20] Batched: true, Format: Parquet, Location [not included in comparison]/{warehouse_dir}/customer_address], PartitionFilters: [], PushedFilters: [IsNotNull(ca_country), EqualTo(ca_country,United States), IsNotNull(ca_address_sk)], ReadSchema: struct<ca_address_sk:int,ca_state:string,ca_country:string>
            :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)))
            :     :        +- *(3) Project [d_date_sk#13]
            :     :           +- *(3) Filter ((isnotnull(d_year#21) && (d_year#21 = 2001)) && isnotnull(d_date_sk#13))
            :     :              +- *(3) FileScan parquet default.date_dim[d_date_sk#13,d_year#21] Batched: true, Format: Parquet, Location [not included in comparison]/{warehouse_dir}/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), EqualTo(d_year,2001), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
            :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)))
            :        +- *(4) Project [cd_demo_sk#11, cd_marital_status#6, cd_education_status#7]
            :           +- *(4) Filter isnotnull(cd_demo_sk#11)
            :              +- *(4) FileScan parquet default.customer_demographics[cd_demo_sk#11,cd_marital_status#6,cd_education_status#7] Batched: true, Format: Parquet, Location [not included in comparison]/{warehouse_dir}/customer_demographics], PartitionFilters: [], PushedFilters: [IsNotNull(cd_demo_sk)], ReadSchema: struct<cd_demo_sk:int,cd_marital_status:string,cd_education_status:string>
            +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)))
               +- *(5) Project [hd_demo_sk#5, hd_dep_count#9]
                  +- *(5) Filter isnotnull(hd_demo_sk#5)
                     +- *(5) FileScan parquet default.household_demographics[hd_demo_sk#5,hd_dep_count#9] Batched: true, Format: Parquet, Location [not included in comparison]/{warehouse_dir}/household_demographics], PartitionFilters: [], PushedFilters: [IsNotNull(hd_demo_sk)], ReadSchema: struct<hd_demo_sk:int,hd_dep_count:int>