TakeOrderedAndProject [(CAST((CAST(CAST(promotions AS DECIMAL(15,4)) AS DECIMAL(15,4)) / CAST(CAST(total AS DECIMAL(15,4)) AS DECIMAL(15,4))) AS DECIMAL(35,20)) * CAST(CAST(100 AS DECIMAL(3,0)) AS DECIMAL(35,20))),promotions,total]
  WholeStageCodegen
    Project [promotions,total]
      InputAdapter
        CartesianProduct
          WholeStageCodegen
            HashAggregate [sum,sum(UnscaledValue(ss_ext_sales_price))] [promotions,sum,sum(UnscaledValue(ss_ext_sales_price))]
              InputAdapter
                Exchange #1
                  WholeStageCodegen
                    HashAggregate [ss_ext_sales_price,sum,sum] [sum,sum]
                      Project [ss_ext_sales_price]
                        SortMergeJoin [i_item_sk,ss_item_sk]
                          InputAdapter
                            WholeStageCodegen
                              Sort [ss_item_sk]
                                InputAdapter
                                  Exchange [ss_item_sk] #2
                                    WholeStageCodegen
                                      Project [ss_ext_sales_price,ss_item_sk]
                                        SortMergeJoin [c_current_addr_sk,ca_address_sk]
                                          InputAdapter
                                            WholeStageCodegen
                                              Sort [c_current_addr_sk]
                                                InputAdapter
                                                  Exchange [c_current_addr_sk] #3
                                                    WholeStageCodegen
                                                      Project [c_current_addr_sk,ss_ext_sales_price,ss_item_sk]
                                                        SortMergeJoin [c_customer_sk,ss_customer_sk]
                                                          InputAdapter
                                                            WholeStageCodegen
                                                              Sort [ss_customer_sk]
                                                                InputAdapter
                                                                  Exchange [ss_customer_sk] #4
                                                                    WholeStageCodegen
                                                                      Project [ss_customer_sk,ss_ext_sales_price,ss_item_sk]
                                                                        SortMergeJoin [d_date_sk,ss_sold_date_sk]
                                                                          InputAdapter
                                                                            WholeStageCodegen
                                                                              Sort [ss_sold_date_sk]
                                                                                InputAdapter
                                                                                  Exchange [ss_sold_date_sk] #5
                                                                                    WholeStageCodegen
                                                                                      Project [ss_customer_sk,ss_ext_sales_price,ss_item_sk,ss_sold_date_sk]
                                                                                        SortMergeJoin [p_promo_sk,ss_promo_sk]
                                                                                          InputAdapter
                                                                                            WholeStageCodegen
                                                                                              Sort [ss_promo_sk]
                                                                                                InputAdapter
                                                                                                  Exchange [ss_promo_sk] #6
                                                                                                    WholeStageCodegen
                                                                                                      Project [ss_customer_sk,ss_ext_sales_price,ss_item_sk,ss_promo_sk,ss_sold_date_sk]
                                                                                                        SortMergeJoin [s_store_sk,ss_store_sk]
                                                                                                          InputAdapter
                                                                                                            WholeStageCodegen
                                                                                                              Project [ss_customer_sk,ss_ext_sales_price,ss_item_sk,ss_promo_sk,ss_sold_date_sk,ss_store_sk]
                                                                                                                Filter [ss_customer_sk,ss_item_sk,ss_promo_sk,ss_sold_date_sk,ss_store_sk]
                                                                                                                  Scan Hyperspace(Type: CI, Name: JoinIndex14-index-5-ss_store_sk-20, LogVersion: 0) default.store_sales [ss_customer_sk,ss_ext_sales_price,ss_item_sk,ss_promo_sk,ss_sold_date_sk,ss_store_sk] [ss_customer_sk,ss_ext_sales_price,ss_item_sk,ss_promo_sk,ss_sold_date_sk,ss_store_sk]
                                                                                                          InputAdapter
                                                                                                            WholeStageCodegen
                                                                                                              Project [s_store_sk]
                                                                                                                Filter [s_gmt_offset,s_store_sk]
                                                                                                                  Scan Hyperspace(Type: CI, Name: JoinIndex24-index-4-s_store_sk-15, LogVersion: 0) default.store [s_gmt_offset,s_store_sk] [s_gmt_offset,s_store_sk]
                                                                                          InputAdapter
                                                                                            WholeStageCodegen
                                                                                              Sort [p_promo_sk]
                                                                                                InputAdapter
                                                                                                  Exchange [p_promo_sk] #7
                                                                                                    WholeStageCodegen
                                                                                                      Project [p_promo_sk]
                                                                                                        Filter [p_channel_dmail,p_channel_email,p_channel_tv,p_promo_sk]
                                                                                                          Scan Hyperspace(Type: CI, Name: JoinIndex49-index-40-p_promo_sk-4, LogVersion: 0) default.promotion [p_channel_dmail,p_channel_email,p_channel_tv,p_promo_sk] [p_channel_dmail,p_channel_email,p_channel_tv,p_promo_sk]
                                                                          InputAdapter
                                                                            WholeStageCodegen
                                                                              Sort [d_date_sk]
                                                                                InputAdapter
                                                                                  Exchange [d_date_sk] #8
                                                                                    WholeStageCodegen
                                                                                      Project [d_date_sk]
                                                                                        Filter [d_date_sk,d_moy,d_year]
                                                                                          Scan Hyperspace(Type: CI, Name: FilterIndex04-index-11-d_year-5, LogVersion: 0) default.date_dim [d_date_sk,d_moy,d_year] [d_date_sk,d_moy,d_year]
                                                          InputAdapter
                                                            WholeStageCodegen
                                                              Sort [c_customer_sk]
                                                                InputAdapter
                                                                  Exchange [c_customer_sk] #9
                                                                    WholeStageCodegen
                                                                      Project [c_current_addr_sk,c_customer_sk]
                                                                        Filter [c_current_addr_sk,c_customer_sk]
                                                                          Scan Hyperspace(Type: CI, Name: JoinIndex43-index-8-c_customer_sk-17, LogVersion: 0) default.customer [c_current_addr_sk,c_customer_sk] [c_current_addr_sk,c_customer_sk]
                                          InputAdapter
                                            WholeStageCodegen
                                              Sort [ca_address_sk]
                                                InputAdapter
                                                  Exchange [ca_address_sk] #10
                                                    WholeStageCodegen
                                                      Project [ca_address_sk]
                                                        Filter [ca_address_sk,ca_gmt_offset]
                                                          Scan Hyperspace(Type: CI, Name: FilterIndex34-index-45-ca_gmt_offset-1, LogVersion: 0) default.customer_address [ca_address_sk,ca_gmt_offset] [ca_address_sk,ca_gmt_offset]
                          InputAdapter
                            WholeStageCodegen
                              Sort [i_item_sk]
                                InputAdapter
                                  Exchange [i_item_sk] #11
                                    WholeStageCodegen
                                      Project [i_item_sk]
                                        Filter [i_category,i_item_sk]
                                          Scan Hyperspace(Type: CI, Name: FilterIndex10-index-39-i_category-9, LogVersion: 0) default.item [i_category,i_item_sk] [i_category,i_item_sk]
          WholeStageCodegen
            HashAggregate [sum,sum(UnscaledValue(ss_ext_sales_price))] [sum,sum(UnscaledValue(ss_ext_sales_price)),total]
              InputAdapter
                Exchange #12
                  WholeStageCodegen
                    HashAggregate [ss_ext_sales_price,sum,sum] [sum,sum]
                      Project [ss_ext_sales_price]
                        SortMergeJoin [i_item_sk,ss_item_sk]
                          InputAdapter
                            WholeStageCodegen
                              Sort [ss_item_sk]
                                InputAdapter
                                  Exchange [ss_item_sk] #13
                                    WholeStageCodegen
                                      Project [ss_ext_sales_price,ss_item_sk]
                                        SortMergeJoin [c_current_addr_sk,ca_address_sk]
                                          InputAdapter
                                            WholeStageCodegen
                                              Sort [c_current_addr_sk]
                                                InputAdapter
                                                  Exchange [c_current_addr_sk] #14
                                                    WholeStageCodegen
                                                      Project [c_current_addr_sk,ss_ext_sales_price,ss_item_sk]
                                                        SortMergeJoin [c_customer_sk,ss_customer_sk]
                                                          InputAdapter
                                                            WholeStageCodegen
                                                              Sort [ss_customer_sk]
                                                                InputAdapter
                                                                  Exchange [ss_customer_sk] #15
                                                                    WholeStageCodegen
                                                                      Project [ss_customer_sk,ss_ext_sales_price,ss_item_sk]
                                                                        SortMergeJoin [d_date_sk,ss_sold_date_sk]
                                                                          InputAdapter
                                                                            WholeStageCodegen
                                                                              Sort [ss_sold_date_sk]
                                                                                InputAdapter
                                                                                  Exchange [ss_sold_date_sk] #16
                                                                                    WholeStageCodegen
                                                                                      Project [ss_customer_sk,ss_ext_sales_price,ss_item_sk,ss_sold_date_sk]
                                                                                        SortMergeJoin [s_store_sk,ss_store_sk]
                                                                                          InputAdapter
                                                                                            WholeStageCodegen
                                                                                              Project [ss_customer_sk,ss_ext_sales_price,ss_item_sk,ss_sold_date_sk,ss_store_sk]
                                                                                                Filter [ss_customer_sk,ss_item_sk,ss_sold_date_sk,ss_store_sk]
                                                                                                  Scan Hyperspace(Type: CI, Name: JoinIndex14-index-5-ss_store_sk-20, LogVersion: 0) default.store_sales [ss_customer_sk,ss_ext_sales_price,ss_item_sk,ss_sold_date_sk,ss_store_sk] [ss_customer_sk,ss_ext_sales_price,ss_item_sk,ss_sold_date_sk,ss_store_sk]
                                                                                          InputAdapter
                                                                                            WholeStageCodegen
                                                                                              Project [s_store_sk]
                                                                                                Filter [s_gmt_offset,s_store_sk]
                                                                                                  Scan Hyperspace(Type: CI, Name: JoinIndex24-index-4-s_store_sk-15, LogVersion: 0) default.store [s_gmt_offset,s_store_sk] [s_gmt_offset,s_store_sk]
                                                                          InputAdapter
                                                                            WholeStageCodegen
                                                                              Sort [d_date_sk]
                                                                                InputAdapter
                                                                                  ReusedExchange [d_date_sk] [d_date_sk] #8
                                                          InputAdapter
                                                            WholeStageCodegen
                                                              Sort [c_customer_sk]
                                                                InputAdapter
                                                                  ReusedExchange [c_current_addr_sk,c_customer_sk] [c_current_addr_sk,c_customer_sk] #9
                                          InputAdapter
                                            WholeStageCodegen
                                              Sort [ca_address_sk]
                                                InputAdapter
                                                  ReusedExchange [ca_address_sk] [ca_address_sk] #10
                          InputAdapter
                            WholeStageCodegen
                              Sort [i_item_sk]
                                InputAdapter
                                  ReusedExchange [i_item_sk] [i_item_sk] #11
