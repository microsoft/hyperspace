== Physical Plan ==
TakeOrderedAndProject(limit=100, orderBy=[cnt#1 ASC NULLS FIRST], output=[state#2,cnt#1])
+- *(21) Project [state#2, cnt#1]
   +- *(21) Filter (count(1)#3 >= 10)
      +- *(21) HashAggregate(keys=[ca_state#4], functions=[count(1)])
         +- Exchange hashpartitioning(ca_state#4, 5)
            +- *(20) HashAggregate(keys=[ca_state#4], functions=[partial_count(1)])
               +- *(20) Project [ca_state#4]
                  +- *(20) SortMergeJoin [ss_item_sk#5], [i_item_sk#6], Inner
                     :- *(12) Sort [ss_item_sk#5 ASC NULLS FIRST], false, 0
                     :  +- Exchange hashpartitioning(ss_item_sk#5, 5)
                     :     +- *(11) Project [ca_state#4, ss_item_sk#5]
                     :        +- *(11) SortMergeJoin [ss_sold_date_sk#7], [d_date_sk#8], Inner
                     :           :- *(8) Sort [ss_sold_date_sk#7 ASC NULLS FIRST], false, 0
                     :           :  +- Exchange hashpartitioning(ss_sold_date_sk#7, 5)
                     :           :     +- *(7) Project [ca_state#4, ss_sold_date_sk#7, ss_item_sk#5]
                     :           :        +- *(7) SortMergeJoin [c_customer_sk#9], [ss_customer_sk#10], Inner
                     :           :           :- *(4) Sort [c_customer_sk#9 ASC NULLS FIRST], false, 0
                     :           :           :  +- Exchange hashpartitioning(c_customer_sk#9, 5)
                     :           :           :     +- *(3) Project [ca_state#4, c_customer_sk#9]
                     :           :           :        +- *(3) SortMergeJoin [ca_address_sk#11], [c_current_addr_sk#12], Inner
                     :           :           :           :- *(1) Project [ca_address_sk#11, ca_state#4]
                     :           :           :           :  +- *(1) Filter isnotnull(ca_address_sk#11)
                     :           :           :           :     +- *(1) FileScan Hyperspace(Type: CI, Name: JoinIndex31-index-7-ca_address_sk-11, LogVersion: 0) default.customer_address[ca_address_sk#11,ca_state#4] Batched: true, Format: Parquet, Location: InMemoryFileIndex[], PartitionFilters: [], PushedFilters: [IsNotNull(ca_address_sk)], ReadSchema: struct<ca_address_sk:int,ca_state:string>, SelectedBucketsCount: 200 out of 200
                     :           :           :           +- *(2) Project [c_customer_sk#9, c_current_addr_sk#12]
                     :           :           :              +- *(2) Filter (isnotnull(c_current_addr_sk#12) && isnotnull(c_customer_sk#9))
                     :           :           :                 +- *(2) FileScan Hyperspace(Type: CI, Name: JoinIndex44-index-16-c_current_addr_sk-17, LogVersion: 0) default.customer[c_customer_sk#9,c_current_addr_sk#12] Batched: true, Format: Parquet, Location: InMemoryFileIndex[], PartitionFilters: [], PushedFilters: [IsNotNull(c_current_addr_sk), IsNotNull(c_customer_sk)], ReadSchema: struct<c_customer_sk:int,c_current_addr_sk:int>, SelectedBucketsCount: 200 out of 200
                     :           :           +- *(6) Sort [ss_customer_sk#10 ASC NULLS FIRST], false, 0
                     :           :              +- Exchange hashpartitioning(ss_customer_sk#10, 5)
                     :           :                 +- *(5) Project [ss_sold_date_sk#7, ss_item_sk#5, ss_customer_sk#10]
                     :           :                    +- *(5) Filter ((isnotnull(ss_customer_sk#10) && isnotnull(ss_sold_date_sk#7)) && isnotnull(ss_item_sk#5))
                     :           :                       +- *(5) FileScan Hyperspace(Type: CI, Name: JoinIndex12-index-1-ss_sold_date_sk-21, LogVersion: 0) default.store_sales[ss_sold_date_sk#7,ss_item_sk#5,ss_customer_sk#10] Batched: true, Format: Parquet, Location: InMemoryFileIndex[], PartitionFilters: [], PushedFilters: [IsNotNull(ss_customer_sk), IsNotNull(ss_sold_date_sk), IsNotNull(ss_item_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int,ss_customer_sk:int>
                     :           +- *(10) Sort [d_date_sk#8 ASC NULLS FIRST], false, 0
                     :              +- Exchange hashpartitioning(d_date_sk#8, 5)
                     :                 +- *(9) Project [d_date_sk#8]
                     :                    +- *(9) Filter ((isnotnull(d_month_seq#13) && (d_month_seq#13 = Subquery subquery2222)) && isnotnull(d_date_sk#8))
                     :                       :  +- Subquery subquery2222
                     :                       :     +- *(2) HashAggregate(keys=[d_month_seq#13], functions=[])
                     :                       :        +- Exchange hashpartitioning(d_month_seq#13, 5)
                     :                       :           +- *(1) HashAggregate(keys=[d_month_seq#13], functions=[])
                     :                       :              +- *(1) Project [d_month_seq#13]
                     :                       :                 +- *(1) Filter (((isnotnull(d_year#14) && isnotnull(d_moy#15)) && (d_year#14 = 2000)) && (d_moy#15 = 1))
                     :                       :                    +- *(1) FileScan parquet default.date_dim[d_month_seq#13,d_year#14,d_moy#15] Batched: true, Format: Parquet, Location [not included in comparison]/{warehouse_dir}/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), IsNotNull(d_moy), EqualTo(d_year,2000), EqualTo(d_moy,1)], ReadSchema: struct<d_month_seq:int,d_year:int,d_moy:int>
                     :                       +- *(9) FileScan Hyperspace(Type: CI, Name: FilterIndex07-index-17-d_month_seq-7, LogVersion: 0) default.date_dim[d_date_sk#8,d_month_seq#13] Batched: true, Format: Parquet, Location: InMemoryFileIndex[], PartitionFilters: [], PushedFilters: [IsNotNull(d_month_seq), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_month_seq:int>
                     :                             +- Subquery subquery2222
                     :                                +- *(2) HashAggregate(keys=[d_month_seq#13], functions=[])
                     :                                   +- Exchange hashpartitioning(d_month_seq#13, 5)
                     :                                      +- *(1) HashAggregate(keys=[d_month_seq#13], functions=[])
                     :                                         +- *(1) Project [d_month_seq#13]
                     :                                            +- *(1) Filter (((isnotnull(d_year#14) && isnotnull(d_moy#15)) && (d_year#14 = 2000)) && (d_moy#15 = 1))
                     :                                               +- *(1) FileScan parquet default.date_dim[d_month_seq#13,d_year#14,d_moy#15] Batched: true, Format: Parquet, Location [not included in comparison]/{warehouse_dir}/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), IsNotNull(d_moy), EqualTo(d_year,2000), EqualTo(d_moy,1)], ReadSchema: struct<d_month_seq:int,d_year:int,d_moy:int>
                     +- *(19) Sort [i_item_sk#6 ASC NULLS FIRST], false, 0
                        +- Exchange hashpartitioning(i_item_sk#6, 5)
                           +- *(18) Project [i_item_sk#6]
                              +- *(18) Filter (cast(i_current_price#16 as decimal(14,7)) > CheckOverflow((1.200000 * promote_precision(avg(i_current_price)#17)), DecimalType(14,7)))
                                 +- SortMergeJoin [i_category#18], [i_category#18#19], LeftOuter
                                    :- *(14) Sort [i_category#18 ASC NULLS FIRST], false, 0
                                    :  +- Exchange hashpartitioning(i_category#18, 5)
                                    :     +- *(13) Project [i_item_sk#6, i_current_price#16, i_category#18]
                                    :        +- *(13) Filter (isnotnull(i_current_price#16) && isnotnull(i_item_sk#6))
                                    :           +- *(13) FileScan Hyperspace(Type: CI, Name: JoinIndex08-index-2-i_item_sk-17, LogVersion: 0) default.item[i_item_sk#6,i_current_price#16,i_category#18] Batched: true, Format: Parquet, Location: InMemoryFileIndex[], PartitionFilters: [], PushedFilters: [IsNotNull(i_current_price), IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_current_price:decimal(7,2),i_category:string>
                                    +- *(17) Sort [i_category#18#19 ASC NULLS FIRST], false, 0
                                       +- Exchange hashpartitioning(i_category#18#19, 5)
                                          +- *(16) HashAggregate(keys=[i_category#18], functions=[avg(UnscaledValue(i_current_price#16))])
                                             +- Exchange hashpartitioning(i_category#18, 5)
                                                +- *(15) HashAggregate(keys=[i_category#18], functions=[partial_avg(UnscaledValue(i_current_price#16))])
                                                   +- *(15) Project [i_current_price#16, i_category#18]
                                                      +- *(15) Filter isnotnull(i_category#18)
                                                         +- *(15) FileScan Hyperspace(Type: CI, Name: FilterIndex10-index-39-i_category-9, LogVersion: 0) default.item[i_current_price#16,i_category#18] Batched: true, Format: Parquet, Location: InMemoryFileIndex[], PartitionFilters: [], PushedFilters: [IsNotNull(i_category)], ReadSchema: struct<i_current_price:decimal(7,2),i_category:string>