== Physical Plan ==
TakeOrderedAndProject(limit=100, orderBy=[order count #1 ASC NULLS FIRST], output=[order count #1,total shipping cost #2,total net profit #3])
+- *(21) HashAggregate(keys=[], functions=[sum(UnscaledValue(cs_ext_ship_cost#4)), sum(UnscaledValue(cs_net_profit#5)), count(distinct cs_order_number#6)])
   +- Exchange SinglePartition
      +- *(20) HashAggregate(keys=[], functions=[merge_sum(UnscaledValue(cs_ext_ship_cost#4)), merge_sum(UnscaledValue(cs_net_profit#5)), partial_count(distinct cs_order_number#6)])
         +- *(20) HashAggregate(keys=[cs_order_number#6], functions=[merge_sum(UnscaledValue(cs_ext_ship_cost#4)), merge_sum(UnscaledValue(cs_net_profit#5))])
            +- Exchange hashpartitioning(cs_order_number#6, 5)
               +- *(19) HashAggregate(keys=[cs_order_number#6], functions=[partial_sum(UnscaledValue(cs_ext_ship_cost#4)), partial_sum(UnscaledValue(cs_net_profit#5))])
                  +- *(19) Project [cs_order_number#6, cs_ext_ship_cost#4, cs_net_profit#5]
                     +- *(19) SortMergeJoin [cs_call_center_sk#7], [cc_call_center_sk#8], Inner
                        :- *(16) Sort [cs_call_center_sk#7 ASC NULLS FIRST], false, 0
                        :  +- Exchange hashpartitioning(cs_call_center_sk#7, 5)
                        :     +- *(15) Project [cs_call_center_sk#7, cs_order_number#6, cs_ext_ship_cost#4, cs_net_profit#5]
                        :        +- *(15) SortMergeJoin [cs_ship_addr_sk#9], [ca_address_sk#10], Inner
                        :           :- *(12) Sort [cs_ship_addr_sk#9 ASC NULLS FIRST], false, 0
                        :           :  +- Exchange hashpartitioning(cs_ship_addr_sk#9, 5)
                        :           :     +- *(11) Project [cs_ship_addr_sk#9, cs_call_center_sk#7, cs_order_number#6, cs_ext_ship_cost#4, cs_net_profit#5]
                        :           :        +- *(11) SortMergeJoin [cs_ship_date_sk#11], [d_date_sk#12], Inner
                        :           :           :- *(8) Sort [cs_ship_date_sk#11 ASC NULLS FIRST], false, 0
                        :           :           :  +- Exchange hashpartitioning(cs_ship_date_sk#11, 5)
                        :           :           :     +- SortMergeJoin [cs_order_number#6], [cr_order_number#13], LeftAnti
                        :           :           :        :- *(5) Project [cs_ship_date_sk#11, cs_ship_addr_sk#9, cs_call_center_sk#7, cs_order_number#6, cs_ext_ship_cost#4, cs_net_profit#5]
                        :           :           :        :  +- SortMergeJoin [cs_order_number#6], [cs_order_number#6#14], LeftSemi, NOT (cs_warehouse_sk#15 = cs_warehouse_sk#15#16)
                        :           :           :        :     :- *(2) Sort [cs_order_number#6 ASC NULLS FIRST], false, 0
                        :           :           :        :     :  +- Exchange hashpartitioning(cs_order_number#6, 5)
                        :           :           :        :     :     +- *(1) Project [cs_ship_date_sk#11, cs_ship_addr_sk#9, cs_call_center_sk#7, cs_warehouse_sk#15, cs_order_number#6, cs_ext_ship_cost#4, cs_net_profit#5]
                        :           :           :        :     :        +- *(1) Filter ((isnotnull(cs_ship_date_sk#11) && isnotnull(cs_ship_addr_sk#9)) && isnotnull(cs_call_center_sk#7))
                        :           :           :        :     :           +- *(1) FileScan parquet default.catalog_sales[cs_ship_date_sk#11,cs_ship_addr_sk#9,cs_call_center_sk#7,cs_warehouse_sk#15,cs_order_number#6,cs_ext_ship_cost#4,cs_net_profit#5] Batched: true, Format: Parquet, Location [not included in comparison]/{warehouse_dir}/catalog_sales], PartitionFilters: [], PushedFilters: [IsNotNull(cs_ship_date_sk), IsNotNull(cs_ship_addr_sk), IsNotNull(cs_call_center_sk)], ReadSchema: struct<cs_ship_date_sk:int,cs_ship_addr_sk:int,cs_call_center_sk:int,cs_warehouse_sk:int,cs_order...
                        :           :           :        :     +- *(4) Sort [cs_order_number#6#14 ASC NULLS FIRST], false, 0
                        :           :           :        :        +- Exchange hashpartitioning(cs_order_number#6#14, 5)
                        :           :           :        :           +- *(3) Project [cs_warehouse_sk#15 AS cs_warehouse_sk#15#16, cs_order_number#6 AS cs_order_number#6#14]
                        :           :           :        :              +- *(3) FileScan parquet default.catalog_sales[cs_warehouse_sk#15,cs_order_number#6] Batched: true, Format: Parquet, Location [not included in comparison]/{warehouse_dir}/catalog_sales], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<cs_warehouse_sk:int,cs_order_number:int>
                        :           :           :        +- *(7) Sort [cr_order_number#13 ASC NULLS FIRST], false, 0
                        :           :           :           +- Exchange hashpartitioning(cr_order_number#13, 5)
                        :           :           :              +- *(6) FileScan parquet default.catalog_returns[cr_order_number#13] Batched: true, Format: Parquet, Location [not included in comparison]/{warehouse_dir}/catalog_returns], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<cr_order_number:int>
                        :           :           +- *(10) Sort [d_date_sk#12 ASC NULLS FIRST], false, 0
                        :           :              +- Exchange hashpartitioning(d_date_sk#12, 5)
                        :           :                 +- *(9) Project [d_date_sk#12]
                        :           :                    +- *(9) Filter (((isnotnull(d_date#17) && (cast(d_date#17 as string) >= 2002-02-01)) && (d_date#17 <= 11779)) && isnotnull(d_date_sk#12))
                        :           :                       +- *(9) FileScan Hyperspace(Type: CI, Name: FilterIndex06-index-14-d_date-2, LogVersion: 0) default.date_dim[d_date_sk#12,d_date#17] Batched: true, Format: Parquet, Location: InMemoryFileIndex[], PartitionFilters: [], PushedFilters: [IsNotNull(d_date), LessThanOrEqual(d_date,2002-04-02), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_date:date>
                        :           +- *(14) Sort [ca_address_sk#10 ASC NULLS FIRST], false, 0
                        :              +- Exchange hashpartitioning(ca_address_sk#10, 5)
                        :                 +- *(13) Project [ca_address_sk#10]
                        :                    +- *(13) Filter ((isnotnull(ca_state#18) && (ca_state#18 = GA)) && isnotnull(ca_address_sk#10))
                        :                       +- *(13) FileScan Hyperspace(Type: CI, Name: FilterIndex32-index-35-ca_state-11, LogVersion: 0) default.customer_address[ca_address_sk#10,ca_state#18] Batched: true, Format: Parquet, Location: InMemoryFileIndex[], PartitionFilters: [], PushedFilters: [IsNotNull(ca_state), EqualTo(ca_state,GA), IsNotNull(ca_address_sk)], ReadSchema: struct<ca_address_sk:int,ca_state:string>
                        +- *(18) Sort [cc_call_center_sk#8 ASC NULLS FIRST], false, 0
                           +- Exchange hashpartitioning(cc_call_center_sk#8, 5)
                              +- *(17) Project [cc_call_center_sk#8]
                                 +- *(17) Filter ((isnotnull(cc_county#19) && (cc_county#19 = Williamson County)) && isnotnull(cc_call_center_sk#8))
                                    +- *(17) FileScan parquet default.call_center[cc_call_center_sk#8,cc_county#19] Batched: true, Format: Parquet, Location [not included in comparison]/{warehouse_dir}/call_center], PartitionFilters: [], PushedFilters: [IsNotNull(cc_county), EqualTo(cc_county,Williamson County), IsNotNull(cc_call_center_sk)], ReadSchema: struct<cc_call_center_sk:int,cc_county:string>