== Physical Plan ==
TakeOrderedAndProject(limit=100, orderBy=[Excess Discount Amount #1 ASC NULLS FIRST], output=[Excess Discount Amount #1])
+- *(14) HashAggregate(keys=[], functions=[sum(UnscaledValue(ws_ext_discount_amt#2))])
   +- Exchange SinglePartition
      +- *(13) HashAggregate(keys=[], functions=[partial_sum(UnscaledValue(ws_ext_discount_amt#2))])
         +- *(13) Project [ws_ext_discount_amt#2]
            +- *(13) SortMergeJoin [ws_sold_date_sk#3], [d_date_sk#4], Inner
               :- *(10) Sort [ws_sold_date_sk#3 ASC NULLS FIRST], false, 0
               :  +- Exchange hashpartitioning(ws_sold_date_sk#3, 5)
               :     +- *(9) Project [ws_sold_date_sk#3, ws_ext_discount_amt#2]
               :        +- *(9) SortMergeJoin [i_item_sk#5], [ws_item_sk#6#7], Inner, (cast(ws_ext_discount_amt#2 as decimal(14,7)) > (CAST(1.3 AS DECIMAL(11,6)) * CAST(avg(ws_ext_discount_amt) AS DECIMAL(11,6)))#8)
               :           :- *(3) Project [ws_sold_date_sk#3, ws_ext_discount_amt#2, i_item_sk#5]
               :           :  +- *(3) SortMergeJoin [ws_item_sk#6], [i_item_sk#5], Inner
               :           :     :- *(1) Project [ws_sold_date_sk#3, ws_item_sk#6, ws_ext_discount_amt#2]
               :           :     :  +- *(1) Filter ((isnotnull(ws_item_sk#6) && isnotnull(ws_ext_discount_amt#2)) && isnotnull(ws_sold_date_sk#3))
               :           :     :     +- *(1) FileScan Hyperspace(Type: CI, Name: JoinIndex38-index-15-ws_item_sk-16, LogVersion: 0) default.web_sales[ws_sold_date_sk#3,ws_item_sk#6,ws_ext_discount_amt#2] Batched: true, Format: Parquet, Location: InMemoryFileIndex[], PartitionFilters: [], PushedFilters: [IsNotNull(ws_item_sk), IsNotNull(ws_ext_discount_amt), IsNotNull(ws_sold_date_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_item_sk:int,ws_ext_discount_amt:decimal(7,2)>, SelectedBucketsCount: 200 out of 200
               :           :     +- *(2) Project [i_item_sk#5]
               :           :        +- *(2) Filter ((isnotnull(i_manufact_id#9) && (i_manufact_id#9 = 350)) && isnotnull(i_item_sk#5))
               :           :           +- *(2) FileScan Hyperspace(Type: CI, Name: JoinIndex08-index-2-i_item_sk-17, LogVersion: 0) default.item[i_item_sk#5,i_manufact_id#9] Batched: true, Format: Parquet, Location: InMemoryFileIndex[], PartitionFilters: [], PushedFilters: [IsNotNull(i_manufact_id), EqualTo(i_manufact_id,350), IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_manufact_id:int>, SelectedBucketsCount: 200 out of 200
               :           +- *(8) Sort [ws_item_sk#6#7 ASC NULLS FIRST], false, 0
               :              +- Exchange hashpartitioning(ws_item_sk#6#7, 200)
               :                 +- *(7) Filter isnotnull((CAST(1.3 AS DECIMAL(11,6)) * CAST(avg(ws_ext_discount_amt) AS DECIMAL(11,6)))#8)
               :                    +- *(7) HashAggregate(keys=[ws_item_sk#6], functions=[avg(UnscaledValue(ws_ext_discount_amt#2))])
               :                       +- Exchange hashpartitioning(ws_item_sk#6, 5)
               :                          +- *(6) HashAggregate(keys=[ws_item_sk#6], functions=[partial_avg(UnscaledValue(ws_ext_discount_amt#2))])
               :                             +- *(6) Project [ws_item_sk#6, ws_ext_discount_amt#2]
               :                                +- *(6) SortMergeJoin [ws_sold_date_sk#3], [d_date_sk#4], Inner
               :                                   :- *(4) Project [ws_sold_date_sk#3, ws_item_sk#6, ws_ext_discount_amt#2]
               :                                   :  +- *(4) Filter (isnotnull(ws_sold_date_sk#3) && isnotnull(ws_item_sk#6))
               :                                   :     +- *(4) FileScan Hyperspace(Type: CI, Name: JoinIndex37-index-9-ws_sold_date_sk-21, LogVersion: 0) default.web_sales[ws_sold_date_sk#3,ws_item_sk#6,ws_ext_discount_amt#2] Batched: true, Format: Parquet, Location: InMemoryFileIndex[], PartitionFilters: [], PushedFilters: [IsNotNull(ws_sold_date_sk), IsNotNull(ws_item_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_item_sk:int,ws_ext_discount_amt:decimal(7,2)>, SelectedBucketsCount: 200 out of 200
               :                                   +- *(5) Project [d_date_sk#4]
               :                                      +- *(5) Filter (((isnotnull(d_date#10) && (cast(d_date#10 as string) >= 2000-01-27)) && (d_date#10 <= 11073)) && isnotnull(d_date_sk#4))
               :                                         +- *(5) FileScan Hyperspace(Type: CI, Name: JoinIndex03-index-0-d_date_sk-10, LogVersion: 0) default.date_dim[d_date_sk#4,d_date#10] Batched: true, Format: Parquet, Location: InMemoryFileIndex[], PartitionFilters: [], PushedFilters: [IsNotNull(d_date), LessThanOrEqual(d_date,2000-04-26), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_date:date>, SelectedBucketsCount: 200 out of 200
               +- *(12) Sort [d_date_sk#4 ASC NULLS FIRST], false, 0
                  +- Exchange hashpartitioning(d_date_sk#4, 5)
                     +- *(11) Project [d_date_sk#4]
                        +- *(11) Filter (((isnotnull(d_date#10) && (cast(d_date#10 as string) >= 2000-01-27)) && (d_date#10 <= 11073)) && isnotnull(d_date_sk#4))
                           +- *(11) FileScan Hyperspace(Type: CI, Name: FilterIndex06-index-14-d_date-2, LogVersion: 0) default.date_dim[d_date_sk#4,d_date#10] Batched: true, Format: Parquet, Location: InMemoryFileIndex[], PartitionFilters: [], PushedFilters: [IsNotNull(d_date), LessThanOrEqual(d_date,2000-04-26), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_date:date>