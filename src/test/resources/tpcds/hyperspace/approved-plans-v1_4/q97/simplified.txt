CollectLimit
  WholeStageCodegen
    HashAggregate [sum,sum,sum,sum(cast(CASE WHEN (isnotnull(customer_sk) && isnotnull(customer_sk)) THEN 1 ELSE 0 END as bigint)),sum(cast(CASE WHEN (isnotnull(customer_sk) && isnull(customer_sk)) THEN 1 ELSE 0 END as bigint)),sum(cast(CASE WHEN (isnull(customer_sk) && isnotnull(customer_sk)) THEN 1 ELSE 0 END as bigint))] [catalog_only,store_and_catalog,store_only,sum,sum,sum,sum(cast(CASE WHEN (isnotnull(customer_sk) && isnotnull(customer_sk)) THEN 1 ELSE 0 END as bigint)),sum(cast(CASE WHEN (isnotnull(customer_sk) && isnull(customer_sk)) THEN 1 ELSE 0 END as bigint)),sum(cast(CASE WHEN (isnull(customer_sk) && isnotnull(customer_sk)) THEN 1 ELSE 0 END as bigint))]
      InputAdapter
        Exchange #1
          WholeStageCodegen
            HashAggregate [customer_sk,customer_sk,sum,sum,sum,sum,sum,sum] [sum,sum,sum,sum,sum,sum]
              Project [customer_sk,customer_sk]
                InputAdapter
                  SortMergeJoin [customer_sk,customer_sk,item_sk,item_sk]
                    WholeStageCodegen
                      Sort [customer_sk,item_sk]
                        InputAdapter
                          Exchange [customer_sk,item_sk] #2
                            WholeStageCodegen
                              HashAggregate [ss_customer_sk,ss_item_sk] [customer_sk,item_sk]
                                InputAdapter
                                  Exchange [ss_customer_sk,ss_item_sk] #3
                                    WholeStageCodegen
                                      HashAggregate [ss_customer_sk,ss_item_sk]
                                        Project [ss_customer_sk,ss_item_sk]
                                          SortMergeJoin [d_date_sk,ss_sold_date_sk]
                                            InputAdapter
                                              WholeStageCodegen
                                                Project [ss_customer_sk,ss_item_sk,ss_sold_date_sk]
                                                  Filter [ss_sold_date_sk]
                                                    Scan Hyperspace(Type: CI, Name: JoinIndex12-index-1-ss_sold_date_sk-21, LogVersion: 0) default.store_sales [ss_customer_sk,ss_item_sk,ss_sold_date_sk] [ss_customer_sk,ss_item_sk,ss_sold_date_sk]
                                            InputAdapter
                                              WholeStageCodegen
                                                Project [d_date_sk]
                                                  Filter [d_date_sk,d_month_seq]
                                                    Scan Hyperspace(Type: CI, Name: JoinIndex03-index-0-d_date_sk-10, LogVersion: 0) default.date_dim [d_date_sk,d_month_seq] [d_date_sk,d_month_seq]
                    WholeStageCodegen
                      Sort [customer_sk,item_sk]
                        InputAdapter
                          Exchange [customer_sk,item_sk] #4
                            WholeStageCodegen
                              HashAggregate [cs_bill_customer_sk,cs_item_sk] [customer_sk,item_sk]
                                InputAdapter
                                  Exchange [cs_bill_customer_sk,cs_item_sk] #5
                                    WholeStageCodegen
                                      HashAggregate [cs_bill_customer_sk,cs_item_sk]
                                        Project [cs_bill_customer_sk,cs_item_sk]
                                          SortMergeJoin [cs_sold_date_sk,d_date_sk]
                                            InputAdapter
                                              WholeStageCodegen
                                                Project [cs_bill_customer_sk,cs_item_sk,cs_sold_date_sk]
                                                  Filter [cs_sold_date_sk]
                                                    Scan Hyperspace(Type: CI, Name: JoinIndex26-index-6-cs_sold_date_sk-26, LogVersion: 0) default.catalog_sales [cs_bill_customer_sk,cs_item_sk,cs_sold_date_sk] [cs_bill_customer_sk,cs_item_sk,cs_sold_date_sk]
                                            InputAdapter
                                              WholeStageCodegen
                                                Project [d_date_sk]
                                                  Filter [d_date_sk,d_month_seq]
                                                    Scan Hyperspace(Type: CI, Name: JoinIndex03-index-0-d_date_sk-10, LogVersion: 0) default.date_dim [d_date_sk,d_month_seq] [d_date_sk,d_month_seq]
