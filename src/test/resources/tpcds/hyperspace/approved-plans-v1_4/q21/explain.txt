== Physical Plan ==
TakeOrderedAndProject(limit=100, orderBy=[w_warehouse_name#1 ASC NULLS FIRST,i_item_id#2 ASC NULLS FIRST], output=[w_warehouse_name#1,i_item_id#2,inv_before#3,inv_after#4])
+- *(12) Filter ((CASE WHEN (inv_before#3 > 0) THEN (cast(inv_after#4 as double) / cast(inv_before#3 as double)) ELSE null END >= 0.666667) && (CASE WHEN (inv_before#3 > 0) THEN (cast(inv_after#4 as double) / cast(inv_before#3 as double)) ELSE null END <= 1.5))
   +- *(12) HashAggregate(keys=[w_warehouse_name#1, i_item_id#2], functions=[sum(cast(CASE WHEN (d_date#5 < 11027) THEN inv_quantity_on_hand#6 ELSE 0 END as bigint)), sum(cast(CASE WHEN (d_date#5 >= 11027) THEN inv_quantity_on_hand#6 ELSE 0 END as bigint))])
      +- Exchange hashpartitioning(w_warehouse_name#1, i_item_id#2, 5)
         +- *(11) HashAggregate(keys=[w_warehouse_name#1, i_item_id#2], functions=[partial_sum(cast(CASE WHEN (d_date#5 < 11027) THEN inv_quantity_on_hand#6 ELSE 0 END as bigint)), partial_sum(cast(CASE WHEN (d_date#5 >= 11027) THEN inv_quantity_on_hand#6 ELSE 0 END as bigint))])
            +- *(11) Project [inv_quantity_on_hand#6, w_warehouse_name#1, i_item_id#2, d_date#5]
               +- *(11) SortMergeJoin [inv_date_sk#7], [d_date_sk#8], Inner
                  :- *(8) Sort [inv_date_sk#7 ASC NULLS FIRST], false, 0
                  :  +- Exchange hashpartitioning(inv_date_sk#7, 5)
                  :     +- *(7) Project [inv_date_sk#7, inv_quantity_on_hand#6, w_warehouse_name#1, i_item_id#2]
                  :        +- *(7) SortMergeJoin [inv_item_sk#9], [i_item_sk#10], Inner
                  :           :- *(4) Sort [inv_item_sk#9 ASC NULLS FIRST], false, 0
                  :           :  +- Exchange hashpartitioning(inv_item_sk#9, 5)
                  :           :     +- *(3) Project [inv_date_sk#7, inv_item_sk#9, inv_quantity_on_hand#6, w_warehouse_name#1]
                  :           :        +- *(3) SortMergeJoin [inv_warehouse_sk#11], [w_warehouse_sk#12], Inner
                  :           :           :- *(1) Project [inv_date_sk#7, inv_item_sk#9, inv_warehouse_sk#11, inv_quantity_on_hand#6]
                  :           :           :  +- *(1) Filter ((isnotnull(inv_warehouse_sk#11) && isnotnull(inv_item_sk#9)) && isnotnull(inv_date_sk#7))
                  :           :           :     +- *(1) FileScan Hyperspace(Type: CI, Name: JoinIndex02-index-42-inv_warehouse_sk-3, LogVersion: 0) default.inventory[inv_date_sk#7,inv_item_sk#9,inv_warehouse_sk#11,inv_quantity_on_hand#6] Batched: true, Format: Parquet, Location: InMemoryFileIndex[], PartitionFilters: [], PushedFilters: [IsNotNull(inv_warehouse_sk), IsNotNull(inv_item_sk), IsNotNull(inv_date_sk)], ReadSchema: struct<inv_date_sk:int,inv_item_sk:int,inv_warehouse_sk:int,inv_quantity_on_hand:int>, SelectedBucketsCount: 200 out of 200
                  :           :           +- *(2) Project [w_warehouse_sk#12, w_warehouse_name#1]
                  :           :              +- *(2) Filter isnotnull(w_warehouse_sk#12)
                  :           :                 +- *(2) FileScan Hyperspace(Type: CI, Name: JoinIndex35-index-24-w_warehouse_sk-6, LogVersion: 0) default.warehouse[w_warehouse_sk#12,w_warehouse_name#1] Batched: true, Format: Parquet, Location: InMemoryFileIndex[], PartitionFilters: [], PushedFilters: [IsNotNull(w_warehouse_sk)], ReadSchema: struct<w_warehouse_sk:int,w_warehouse_name:string>, SelectedBucketsCount: 200 out of 200
                  :           +- *(6) Sort [i_item_sk#10 ASC NULLS FIRST], false, 0
                  :              +- Exchange hashpartitioning(i_item_sk#10, 5)
                  :                 +- *(5) Project [i_item_sk#10, i_item_id#2]
                  :                    +- *(5) Filter (((isnotnull(i_current_price#13) && (i_current_price#13 >= 0.99)) && (i_current_price#13 <= 1.49)) && isnotnull(i_item_sk#10))
                  :                       +- *(5) FileScan Hyperspace(Type: CI, Name: JoinIndex08-index-2-i_item_sk-17, LogVersion: 0) default.item[i_item_sk#10,i_item_id#2,i_current_price#13] Batched: true, Format: Parquet, Location: InMemoryFileIndex[], PartitionFilters: [], PushedFilters: [IsNotNull(i_current_price), GreaterThanOrEqual(i_current_price,0.99), LessThanOrEqual(i_current_..., ReadSchema: struct<i_item_sk:int,i_item_id:string,i_current_price:decimal(7,2)>
                  +- *(10) Sort [d_date_sk#8 ASC NULLS FIRST], false, 0
                     +- Exchange hashpartitioning(d_date_sk#8, 5)
                        +- *(9) Project [d_date_sk#8, d_date#5]
                           +- *(9) Filter (((isnotnull(d_date#5) && (d_date#5 >= 10997)) && (d_date#5 <= 11057)) && isnotnull(d_date_sk#8))
                              +- *(9) FileScan Hyperspace(Type: CI, Name: FilterIndex06-index-14-d_date-2, LogVersion: 0) default.date_dim[d_date_sk#8,d_date#5] Batched: true, Format: Parquet, Location: InMemoryFileIndex[], PartitionFilters: [], PushedFilters: [IsNotNull(d_date), GreaterThanOrEqual(d_date,2000-02-10), LessThanOrEqual(d_date,2000-04-10), Is..., ReadSchema: struct<d_date_sk:int,d_date:date>