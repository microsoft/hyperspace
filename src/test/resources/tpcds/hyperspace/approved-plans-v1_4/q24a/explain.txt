== Physical Plan ==
*(23) Project [c_last_name#1, c_first_name#2, s_store_name#3, paid#4]
+- *(23) Filter (isnotnull(sum(netpaid#5)#6) && (cast(sum(netpaid#5)#6 as decimal(33,8)) > cast(Subquery subquery4432 as decimal(33,8))))
   :  +- Subquery subquery4432
   :     +- *(23) HashAggregate(keys=[], functions=[avg(netpaid#5)])
   :        +- Exchange SinglePartition
   :           +- *(22) HashAggregate(keys=[], functions=[partial_avg(netpaid#5)])
   :              +- *(22) HashAggregate(keys=[c_last_name#1, c_first_name#2, s_store_name#3, ca_state#7, s_state#8, i_color#9, i_current_price#10, i_manager_id#11, i_units#12, i_size#13], functions=[sum(UnscaledValue(ss_net_paid#14))])
   :                 +- Exchange hashpartitioning(c_last_name#1, c_first_name#2, s_store_name#3, ca_state#7, s_state#8, i_color#9, i_current_price#10, i_manager_id#11, i_units#12, i_size#13, 5)
   :                    +- *(21) HashAggregate(keys=[c_last_name#1, c_first_name#2, s_store_name#3, ca_state#7, s_state#8, i_color#9, i_current_price#10, i_manager_id#11, i_units#12, i_size#13], functions=[partial_sum(UnscaledValue(ss_net_paid#14))])
   :                       +- *(21) Project [ss_net_paid#14, s_store_name#3, s_state#8, i_current_price#10, i_size#13, i_color#9, i_units#12, i_manager_id#11, c_first_name#2, c_last_name#1, ca_state#7]
   :                          +- *(21) SortMergeJoin [c_birth_country#15, s_zip#16], [upper(ca_country#17), ca_zip#18], Inner
   :                             :- *(18) Sort [c_birth_country#15 ASC NULLS FIRST, s_zip#16 ASC NULLS FIRST], false, 0
   :                             :  +- Exchange hashpartitioning(c_birth_country#15, s_zip#16, 5)
   :                             :     +- *(17) Project [ss_net_paid#14, s_store_name#3, s_state#8, s_zip#16, i_current_price#10, i_size#13, i_color#9, i_units#12, i_manager_id#11, c_first_name#2, c_last_name#1, c_birth_country#15]
   :                             :        +- *(17) SortMergeJoin [ss_customer_sk#19], [c_customer_sk#20], Inner
   :                             :           :- *(14) Sort [ss_customer_sk#19 ASC NULLS FIRST], false, 0
   :                             :           :  +- Exchange hashpartitioning(ss_customer_sk#19, 5)
   :                             :           :     +- *(13) Project [ss_customer_sk#19, ss_net_paid#14, s_store_name#3, s_state#8, s_zip#16, i_current_price#10, i_size#13, i_color#9, i_units#12, i_manager_id#11]
   :                             :           :        +- *(13) SortMergeJoin [ss_item_sk#21], [i_item_sk#22], Inner
   :                             :           :           :- *(10) Sort [ss_item_sk#21 ASC NULLS FIRST], false, 0
   :                             :           :           :  +- Exchange hashpartitioning(ss_item_sk#21, 5)
   :                             :           :           :     +- *(9) Project [ss_item_sk#21, ss_customer_sk#19, ss_net_paid#14, s_store_name#3, s_state#8, s_zip#16]
   :                             :           :           :        +- *(9) SortMergeJoin [ss_store_sk#23], [s_store_sk#24], Inner
   :                             :           :           :           :- *(6) Sort [ss_store_sk#23 ASC NULLS FIRST], false, 0
   :                             :           :           :           :  +- Exchange hashpartitioning(ss_store_sk#23, 5)
   :                             :           :           :           :     +- *(5) Project [ss_item_sk#21, ss_customer_sk#19, ss_store_sk#23, ss_net_paid#14]
   :                             :           :           :           :        +- *(5) SortMergeJoin [cast(ss_ticket_number#25 as bigint), cast(ss_item_sk#21 as bigint)], [sr_ticket_number#26, sr_item_sk#27], Inner
   :                             :           :           :           :           :- *(2) Sort [cast(ss_ticket_number#25 as bigint) ASC NULLS FIRST, cast(ss_item_sk#21 as bigint) ASC NULLS FIRST], false, 0
   :                             :           :           :           :           :  +- Exchange hashpartitioning(cast(ss_ticket_number#25 as bigint), cast(ss_item_sk#21 as bigint), 5)
   :                             :           :           :           :           :     +- *(1) Project [ss_item_sk#21, ss_customer_sk#19, ss_store_sk#23, ss_ticket_number#25, ss_net_paid#14]
   :                             :           :           :           :           :        +- *(1) Filter (((isnotnull(ss_ticket_number#25) && isnotnull(ss_item_sk#21)) && isnotnull(ss_store_sk#23)) && isnotnull(ss_customer_sk#19))
   :                             :           :           :           :           :           +- *(1) FileScan Hyperspace(Type: CI, Name: JoinIndex13-index-3-ss_item_sk-16, LogVersion: 0) default.store_sales[ss_item_sk#21,ss_customer_sk#19,ss_store_sk#23,ss_ticket_number#25,ss_net_paid#14] Batched: true, Format: Parquet, Location: InMemoryFileIndex[], PartitionFilters: [], PushedFilters: [IsNotNull(ss_ticket_number), IsNotNull(ss_item_sk), IsNotNull(ss_store_sk), IsNotNull(ss_custome..., ReadSchema: struct<ss_item_sk:int,ss_customer_sk:int,ss_store_sk:int,ss_ticket_number:int,ss_net_paid:decimal...
   :                             :           :           :           :           +- *(4) Sort [sr_ticket_number#26 ASC NULLS FIRST, sr_item_sk#27 ASC NULLS FIRST], false, 0
   :                             :           :           :           :              +- Exchange hashpartitioning(sr_ticket_number#26, sr_item_sk#27, 5)
   :                             :           :           :           :                 +- *(3) Project [sr_item_sk#27, sr_ticket_number#26]
   :                             :           :           :           :                    +- *(3) Filter (isnotnull(sr_ticket_number#26) && isnotnull(sr_item_sk#27))
   :                             :           :           :           :                       +- *(3) FileScan Hyperspace(Type: CI, Name: JoinIndex21-index-20-sr_item_sk-7, LogVersion: 0) default.store_returns[sr_item_sk#27,sr_ticket_number#26] Batched: true, Format: Parquet, Location: InMemoryFileIndex[], PartitionFilters: [], PushedFilters: [IsNotNull(sr_ticket_number), IsNotNull(sr_item_sk)], ReadSchema: struct<sr_item_sk:bigint,sr_ticket_number:bigint>
   :                             :           :           :           +- *(8) Sort [s_store_sk#24 ASC NULLS FIRST], false, 0
   :                             :           :           :              +- Exchange hashpartitioning(s_store_sk#24, 5)
   :                             :           :           :                 +- *(7) Project [s_store_sk#24, s_store_name#3, s_state#8, s_zip#16]
   :                             :           :           :                    +- *(7) Filter (((isnotnull(s_market_id#28) && (s_market_id#28 = 8)) && isnotnull(s_store_sk#24)) && isnotnull(s_zip#16))
   :                             :           :           :                       +- *(7) FileScan Hyperspace(Type: CI, Name: JoinIndex24-index-4-s_store_sk-15, LogVersion: 0) default.store[s_store_sk#24,s_store_name#3,s_market_id#28,s_state#8,s_zip#16] Batched: true, Format: Parquet, Location: InMemoryFileIndex[], PartitionFilters: [], PushedFilters: [IsNotNull(s_market_id), EqualTo(s_market_id,8), IsNotNull(s_store_sk), IsNotNull(s_zip)], ReadSchema: struct<s_store_sk:int,s_store_name:string,s_market_id:int,s_state:string,s_zip:string>
   :                             :           :           +- *(12) Sort [i_item_sk#22 ASC NULLS FIRST], false, 0
   :                             :           :              +- Exchange hashpartitioning(i_item_sk#22, 5)
   :                             :           :                 +- *(11) Project [i_item_sk#22, i_current_price#10, i_size#13, i_color#9, i_units#12, i_manager_id#11]
   :                             :           :                    +- *(11) Filter isnotnull(i_item_sk#22)
   :                             :           :                       +- *(11) FileScan Hyperspace(Type: CI, Name: JoinIndex08-index-2-i_item_sk-17, LogVersion: 0) default.item[i_item_sk#22,i_current_price#10,i_size#13,i_color#9,i_units#12,i_manager_id#11] Batched: true, Format: Parquet, Location: InMemoryFileIndex[], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_current_price:decimal(7,2),i_size:string,i_color:string,i_units:string,i_m...
   :                             :           +- *(16) Sort [c_customer_sk#20 ASC NULLS FIRST], false, 0
   :                             :              +- Exchange hashpartitioning(c_customer_sk#20, 5)
   :                             :                 +- *(15) Project [c_customer_sk#20, c_first_name#2, c_last_name#1, c_birth_country#15]
   :                             :                    +- *(15) Filter (isnotnull(c_customer_sk#20) && isnotnull(c_birth_country#15))
   :                             :                       +- *(15) FileScan Hyperspace(Type: CI, Name: JoinIndex43-index-8-c_customer_sk-17, LogVersion: 0) default.customer[c_customer_sk#20,c_first_name#2,c_last_name#1,c_birth_country#15] Batched: true, Format: Parquet, Location: InMemoryFileIndex[], PartitionFilters: [], PushedFilters: [IsNotNull(c_customer_sk), IsNotNull(c_birth_country)], ReadSchema: struct<c_customer_sk:int,c_first_name:string,c_last_name:string,c_birth_country:string>
   :                             +- *(20) Sort [upper(ca_country#17) ASC NULLS FIRST, ca_zip#18 ASC NULLS FIRST], false, 0
   :                                +- Exchange hashpartitioning(upper(ca_country#17), ca_zip#18, 5)
   :                                   +- *(19) Project [ca_state#7, ca_zip#18, ca_country#17]
   :                                      +- *(19) Filter isnotnull(ca_zip#18)
   :                                         +- *(19) FileScan parquet default.customer_address[ca_state#7,ca_zip#18,ca_country#17] Batched: true, Format: Parquet, Location [not included in comparison]/{warehouse_dir}/customer_address], PartitionFilters: [], PushedFilters: [IsNotNull(ca_zip)], ReadSchema: struct<ca_state:string,ca_zip:string,ca_country:string>
   +- *(23) HashAggregate(keys=[c_last_name#1, c_first_name#2, s_store_name#3], functions=[sum(netpaid#5)])
      +- Exchange hashpartitioning(c_last_name#1, c_first_name#2, s_store_name#3, 5)
         +- *(22) HashAggregate(keys=[c_last_name#1, c_first_name#2, s_store_name#3], functions=[partial_sum(netpaid#5)])
            +- *(22) HashAggregate(keys=[c_last_name#1, c_first_name#2, s_store_name#3, ca_state#7, s_state#8, i_color#9, i_current_price#10, i_manager_id#11, i_units#12, i_size#13], functions=[sum(UnscaledValue(ss_net_paid#14))])
               +- Exchange hashpartitioning(c_last_name#1, c_first_name#2, s_store_name#3, ca_state#7, s_state#8, i_color#9, i_current_price#10, i_manager_id#11, i_units#12, i_size#13, 5)
                  +- *(21) HashAggregate(keys=[c_last_name#1, c_first_name#2, s_store_name#3, ca_state#7, s_state#8, i_color#9, i_current_price#10, i_manager_id#11, i_units#12, i_size#13], functions=[partial_sum(UnscaledValue(ss_net_paid#14))])
                     +- *(21) Project [ss_net_paid#14, s_store_name#3, s_state#8, i_current_price#10, i_size#13, i_color#9, i_units#12, i_manager_id#11, c_first_name#2, c_last_name#1, ca_state#7]
                        +- *(21) SortMergeJoin [c_birth_country#15, s_zip#16], [upper(ca_country#17), ca_zip#18], Inner
                           :- *(18) Sort [c_birth_country#15 ASC NULLS FIRST, s_zip#16 ASC NULLS FIRST], false, 0
                           :  +- Exchange hashpartitioning(c_birth_country#15, s_zip#16, 5)
                           :     +- *(17) Project [ss_net_paid#14, s_store_name#3, s_state#8, s_zip#16, i_current_price#10, i_size#13, i_color#9, i_units#12, i_manager_id#11, c_first_name#2, c_last_name#1, c_birth_country#15]
                           :        +- *(17) SortMergeJoin [ss_customer_sk#19], [c_customer_sk#20], Inner
                           :           :- *(14) Sort [ss_customer_sk#19 ASC NULLS FIRST], false, 0
                           :           :  +- Exchange hashpartitioning(ss_customer_sk#19, 5)
                           :           :     +- *(13) Project [ss_customer_sk#19, ss_net_paid#14, s_store_name#3, s_state#8, s_zip#16, i_current_price#10, i_size#13, i_color#9, i_units#12, i_manager_id#11]
                           :           :        +- *(13) SortMergeJoin [ss_item_sk#21], [i_item_sk#22], Inner
                           :           :           :- *(10) Sort [ss_item_sk#21 ASC NULLS FIRST], false, 0
                           :           :           :  +- Exchange hashpartitioning(ss_item_sk#21, 5)
                           :           :           :     +- *(9) Project [ss_item_sk#21, ss_customer_sk#19, ss_net_paid#14, s_store_name#3, s_state#8, s_zip#16]
                           :           :           :        +- *(9) SortMergeJoin [ss_store_sk#23], [s_store_sk#24], Inner
                           :           :           :           :- *(6) Sort [ss_store_sk#23 ASC NULLS FIRST], false, 0
                           :           :           :           :  +- Exchange hashpartitioning(ss_store_sk#23, 5)
                           :           :           :           :     +- *(5) Project [ss_item_sk#21, ss_customer_sk#19, ss_store_sk#23, ss_net_paid#14]
                           :           :           :           :        +- *(5) SortMergeJoin [cast(ss_ticket_number#25 as bigint), cast(ss_item_sk#21 as bigint)], [sr_ticket_number#26, sr_item_sk#27], Inner
                           :           :           :           :           :- *(2) Sort [cast(ss_ticket_number#25 as bigint) ASC NULLS FIRST, cast(ss_item_sk#21 as bigint) ASC NULLS FIRST], false, 0
                           :           :           :           :           :  +- Exchange hashpartitioning(cast(ss_ticket_number#25 as bigint), cast(ss_item_sk#21 as bigint), 5)
                           :           :           :           :           :     +- *(1) Project [ss_item_sk#21, ss_customer_sk#19, ss_store_sk#23, ss_ticket_number#25, ss_net_paid#14]
                           :           :           :           :           :        +- *(1) Filter (((isnotnull(ss_ticket_number#25) && isnotnull(ss_item_sk#21)) && isnotnull(ss_store_sk#23)) && isnotnull(ss_customer_sk#19))
                           :           :           :           :           :           +- *(1) FileScan Hyperspace(Type: CI, Name: JoinIndex13-index-3-ss_item_sk-16, LogVersion: 0) default.store_sales[ss_item_sk#21,ss_customer_sk#19,ss_store_sk#23,ss_ticket_number#25,ss_net_paid#14] Batched: true, Format: Parquet, Location: InMemoryFileIndex[], PartitionFilters: [], PushedFilters: [IsNotNull(ss_ticket_number), IsNotNull(ss_item_sk), IsNotNull(ss_store_sk), IsNotNull(ss_custome..., ReadSchema: struct<ss_item_sk:int,ss_customer_sk:int,ss_store_sk:int,ss_ticket_number:int,ss_net_paid:decimal...
                           :           :           :           :           +- *(4) Sort [sr_ticket_number#26 ASC NULLS FIRST, sr_item_sk#27 ASC NULLS FIRST], false, 0
                           :           :           :           :              +- Exchange hashpartitioning(sr_ticket_number#26, sr_item_sk#27, 5)
                           :           :           :           :                 +- *(3) Project [sr_item_sk#27, sr_ticket_number#26]
                           :           :           :           :                    +- *(3) Filter (isnotnull(sr_ticket_number#26) && isnotnull(sr_item_sk#27))
                           :           :           :           :                       +- *(3) FileScan Hyperspace(Type: CI, Name: JoinIndex21-index-20-sr_item_sk-7, LogVersion: 0) default.store_returns[sr_item_sk#27,sr_ticket_number#26] Batched: true, Format: Parquet, Location: InMemoryFileIndex[], PartitionFilters: [], PushedFilters: [IsNotNull(sr_ticket_number), IsNotNull(sr_item_sk)], ReadSchema: struct<sr_item_sk:bigint,sr_ticket_number:bigint>
                           :           :           :           +- *(8) Sort [s_store_sk#24 ASC NULLS FIRST], false, 0
                           :           :           :              +- Exchange hashpartitioning(s_store_sk#24, 5)
                           :           :           :                 +- *(7) Project [s_store_sk#24, s_store_name#3, s_state#8, s_zip#16]
                           :           :           :                    +- *(7) Filter (((isnotnull(s_market_id#28) && (s_market_id#28 = 8)) && isnotnull(s_store_sk#24)) && isnotnull(s_zip#16))
                           :           :           :                       +- *(7) FileScan Hyperspace(Type: CI, Name: JoinIndex24-index-4-s_store_sk-15, LogVersion: 0) default.store[s_store_sk#24,s_store_name#3,s_market_id#28,s_state#8,s_zip#16] Batched: true, Format: Parquet, Location: InMemoryFileIndex[], PartitionFilters: [], PushedFilters: [IsNotNull(s_market_id), EqualTo(s_market_id,8), IsNotNull(s_store_sk), IsNotNull(s_zip)], ReadSchema: struct<s_store_sk:int,s_store_name:string,s_market_id:int,s_state:string,s_zip:string>
                           :           :           +- *(12) Sort [i_item_sk#22 ASC NULLS FIRST], false, 0
                           :           :              +- Exchange hashpartitioning(i_item_sk#22, 5)
                           :           :                 +- *(11) Project [i_item_sk#22, i_current_price#10, i_size#13, i_color#9, i_units#12, i_manager_id#11]
                           :           :                    +- *(11) Filter ((isnotnull(i_color#9) && (i_color#9 = pale)) && isnotnull(i_item_sk#22))
                           :           :                       +- *(11) FileScan Hyperspace(Type: CI, Name: JoinIndex08-index-2-i_item_sk-17, LogVersion: 0) default.item[i_item_sk#22,i_current_price#10,i_size#13,i_color#9,i_units#12,i_manager_id#11] Batched: true, Format: Parquet, Location: InMemoryFileIndex[], PartitionFilters: [], PushedFilters: [IsNotNull(i_color), EqualTo(i_color,pale), IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_current_price:decimal(7,2),i_size:string,i_color:string,i_units:string,i_m...
                           :           +- *(16) Sort [c_customer_sk#20 ASC NULLS FIRST], false, 0
                           :              +- Exchange hashpartitioning(c_customer_sk#20, 5)
                           :                 +- *(15) Project [c_customer_sk#20, c_first_name#2, c_last_name#1, c_birth_country#15]
                           :                    +- *(15) Filter (isnotnull(c_customer_sk#20) && isnotnull(c_birth_country#15))
                           :                       +- *(15) FileScan Hyperspace(Type: CI, Name: JoinIndex43-index-8-c_customer_sk-17, LogVersion: 0) default.customer[c_customer_sk#20,c_first_name#2,c_last_name#1,c_birth_country#15] Batched: true, Format: Parquet, Location: InMemoryFileIndex[], PartitionFilters: [], PushedFilters: [IsNotNull(c_customer_sk), IsNotNull(c_birth_country)], ReadSchema: struct<c_customer_sk:int,c_first_name:string,c_last_name:string,c_birth_country:string>
                           +- *(20) Sort [upper(ca_country#17) ASC NULLS FIRST, ca_zip#18 ASC NULLS FIRST], false, 0
                              +- Exchange hashpartitioning(upper(ca_country#17), ca_zip#18, 5)
                                 +- *(19) Project [ca_state#7, ca_zip#18, ca_country#17]
                                    +- *(19) Filter isnotnull(ca_zip#18)
                                       +- *(19) FileScan parquet default.customer_address[ca_state#7,ca_zip#18,ca_country#17] Batched: true, Format: Parquet, Location [not included in comparison]/{warehouse_dir}/customer_address], PartitionFilters: [], PushedFilters: [IsNotNull(ca_zip)], ReadSchema: struct<ca_state:string,ca_zip:string,ca_country:string>