== Physical Plan ==
TakeOrderedAndProject(limit=100, orderBy=[substring(w_warehouse_name, 1, 20)#1 ASC NULLS FIRST,sm_type#2 ASC NULLS FIRST,cc_name#3 ASC NULLS FIRST], output=[substring(w_warehouse_name, 1, 20)#1,sm_type#2,cc_name#3,30 days #4,31 - 60 days #5,61 - 90 days #6,91 - 120 days #7,>120 days #8])
+- *(18) HashAggregate(keys=[substring(w_warehouse_name#9, 1, 20)#10, sm_type#2, cc_name#3], functions=[sum(cast(CASE WHEN ((cs_ship_date_sk#11 - cs_sold_date_sk#12) <= 30) THEN 1 ELSE 0 END as bigint)), sum(cast(CASE WHEN (((cs_ship_date_sk#11 - cs_sold_date_sk#12) > 30) && ((cs_ship_date_sk#11 - cs_sold_date_sk#12) <= 60)) THEN 1 ELSE 0 END as bigint)), sum(cast(CASE WHEN (((cs_ship_date_sk#11 - cs_sold_date_sk#12) > 60) && ((cs_ship_date_sk#11 - cs_sold_date_sk#12) <= 90)) THEN 1 ELSE 0 END as bigint)), sum(cast(CASE WHEN (((cs_ship_date_sk#11 - cs_sold_date_sk#12) > 90) && ((cs_ship_date_sk#11 - cs_sold_date_sk#12) <= 120)) THEN 1 ELSE 0 END as bigint)), sum(cast(CASE WHEN ((cs_ship_date_sk#11 - cs_sold_date_sk#12) > 120) THEN 1 ELSE 0 END as bigint))])
   +- Exchange hashpartitioning(substring(w_warehouse_name#9, 1, 20)#10, sm_type#2, cc_name#3, 5)
      +- *(17) HashAggregate(keys=[substring(w_warehouse_name#9, 1, 20) AS substring(w_warehouse_name#9, 1, 20)#10, sm_type#2, cc_name#3], functions=[partial_sum(cast(CASE WHEN ((cs_ship_date_sk#11 - cs_sold_date_sk#12) <= 30) THEN 1 ELSE 0 END as bigint)), partial_sum(cast(CASE WHEN (((cs_ship_date_sk#11 - cs_sold_date_sk#12) > 30) && ((cs_ship_date_sk#11 - cs_sold_date_sk#12) <= 60)) THEN 1 ELSE 0 END as bigint)), partial_sum(cast(CASE WHEN (((cs_ship_date_sk#11 - cs_sold_date_sk#12) > 60) && ((cs_ship_date_sk#11 - cs_sold_date_sk#12) <= 90)) THEN 1 ELSE 0 END as bigint)), partial_sum(cast(CASE WHEN (((cs_ship_date_sk#11 - cs_sold_date_sk#12) > 90) && ((cs_ship_date_sk#11 - cs_sold_date_sk#12) <= 120)) THEN 1 ELSE 0 END as bigint)), partial_sum(cast(CASE WHEN ((cs_ship_date_sk#11 - cs_sold_date_sk#12) > 120) THEN 1 ELSE 0 END as bigint))])
         +- *(17) Project [cs_sold_date_sk#12, cs_ship_date_sk#11, w_warehouse_name#9, sm_type#2, cc_name#3]
            +- *(17) SortMergeJoin [cs_ship_date_sk#11], [d_date_sk#13], Inner
               :- *(14) Sort [cs_ship_date_sk#11 ASC NULLS FIRST], false, 0
               :  +- Exchange hashpartitioning(cs_ship_date_sk#11, 5)
               :     +- *(13) Project [cs_sold_date_sk#12, cs_ship_date_sk#11, w_warehouse_name#9, sm_type#2, cc_name#3]
               :        +- *(13) SortMergeJoin [cs_call_center_sk#14], [cc_call_center_sk#15], Inner
               :           :- *(10) Sort [cs_call_center_sk#14 ASC NULLS FIRST], false, 0
               :           :  +- Exchange hashpartitioning(cs_call_center_sk#14, 5)
               :           :     +- *(9) Project [cs_sold_date_sk#12, cs_ship_date_sk#11, cs_call_center_sk#14, w_warehouse_name#9, sm_type#2]
               :           :        +- *(9) SortMergeJoin [cs_ship_mode_sk#16], [sm_ship_mode_sk#17], Inner
               :           :           :- *(6) Sort [cs_ship_mode_sk#16 ASC NULLS FIRST], false, 0
               :           :           :  +- Exchange hashpartitioning(cs_ship_mode_sk#16, 5)
               :           :           :     +- *(5) Project [cs_sold_date_sk#12, cs_ship_date_sk#11, cs_call_center_sk#14, cs_ship_mode_sk#16, w_warehouse_name#9]
               :           :           :        +- *(5) SortMergeJoin [cs_warehouse_sk#18], [w_warehouse_sk#19], Inner
               :           :           :           :- *(2) Sort [cs_warehouse_sk#18 ASC NULLS FIRST], false, 0
               :           :           :           :  +- Exchange hashpartitioning(cs_warehouse_sk#18, 5)
               :           :           :           :     +- *(1) Project [cs_sold_date_sk#12, cs_ship_date_sk#11, cs_call_center_sk#14, cs_ship_mode_sk#16, cs_warehouse_sk#18]
               :           :           :           :        +- *(1) Filter (((isnotnull(cs_warehouse_sk#18) && isnotnull(cs_ship_mode_sk#16)) && isnotnull(cs_call_center_sk#14)) && isnotnull(cs_ship_date_sk#11))
               :           :           :           :           +- *(1) FileScan parquet default.catalog_sales[cs_sold_date_sk#12,cs_ship_date_sk#11,cs_call_center_sk#14,cs_ship_mode_sk#16,cs_warehouse_sk#18] Batched: true, Format: Parquet, Location [not included in comparison]/{warehouse_dir}/catalog_sales], PartitionFilters: [], PushedFilters: [IsNotNull(cs_warehouse_sk), IsNotNull(cs_ship_mode_sk), IsNotNull(cs_call_center_sk), IsNotNull(..., ReadSchema: struct<cs_sold_date_sk:int,cs_ship_date_sk:int,cs_call_center_sk:int,cs_ship_mode_sk:int,cs_wareh...
               :           :           :           +- *(4) Sort [w_warehouse_sk#19 ASC NULLS FIRST], false, 0
               :           :           :              +- Exchange hashpartitioning(w_warehouse_sk#19, 5)
               :           :           :                 +- *(3) Project [w_warehouse_sk#19, w_warehouse_name#9]
               :           :           :                    +- *(3) Filter isnotnull(w_warehouse_sk#19)
               :           :           :                       +- *(3) FileScan Hyperspace(Type: CI, Name: JoinIndex35-index-24-w_warehouse_sk-6, LogVersion: 0) default.warehouse[w_warehouse_sk#19,w_warehouse_name#9] Batched: true, Format: Parquet, Location: InMemoryFileIndex[], PartitionFilters: [], PushedFilters: [IsNotNull(w_warehouse_sk)], ReadSchema: struct<w_warehouse_sk:int,w_warehouse_name:string>
               :           :           +- *(8) Sort [sm_ship_mode_sk#17 ASC NULLS FIRST], false, 0
               :           :              +- Exchange hashpartitioning(sm_ship_mode_sk#17, 5)
               :           :                 +- *(7) Project [sm_ship_mode_sk#17, sm_type#2]
               :           :                    +- *(7) Filter isnotnull(sm_ship_mode_sk#17)
               :           :                       +- *(7) FileScan parquet default.ship_mode[sm_ship_mode_sk#17,sm_type#2] Batched: true, Format: Parquet, Location [not included in comparison]/{warehouse_dir}/ship_mode], PartitionFilters: [], PushedFilters: [IsNotNull(sm_ship_mode_sk)], ReadSchema: struct<sm_ship_mode_sk:int,sm_type:string>
               :           +- *(12) Sort [cc_call_center_sk#15 ASC NULLS FIRST], false, 0
               :              +- Exchange hashpartitioning(cc_call_center_sk#15, 5)
               :                 +- *(11) Project [cc_call_center_sk#15, cc_name#3]
               :                    +- *(11) Filter isnotnull(cc_call_center_sk#15)
               :                       +- *(11) FileScan parquet default.call_center[cc_call_center_sk#15,cc_name#3] Batched: true, Format: Parquet, Location [not included in comparison]/{warehouse_dir}/call_center], PartitionFilters: [], PushedFilters: [IsNotNull(cc_call_center_sk)], ReadSchema: struct<cc_call_center_sk:int,cc_name:string>
               +- *(16) Sort [d_date_sk#13 ASC NULLS FIRST], false, 0
                  +- Exchange hashpartitioning(d_date_sk#13, 5)
                     +- *(15) Project [d_date_sk#13]
                        +- *(15) Filter (((isnotnull(d_month_seq#20) && (d_month_seq#20 >= 1200)) && (d_month_seq#20 <= 1211)) && isnotnull(d_date_sk#13))
                           +- *(15) FileScan Hyperspace(Type: CI, Name: FilterIndex07-index-17-d_month_seq-7, LogVersion: 0) default.date_dim[d_date_sk#13,d_month_seq#20] Batched: true, Format: Parquet, Location: InMemoryFileIndex[], PartitionFilters: [], PushedFilters: [IsNotNull(d_month_seq), GreaterThanOrEqual(d_month_seq,1200), LessThanOrEqual(d_month_seq,1211),..., ReadSchema: struct<d_date_sk:int,d_month_seq:int>