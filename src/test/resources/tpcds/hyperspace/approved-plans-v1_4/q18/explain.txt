== Physical Plan ==
TakeOrderedAndProject(limit=100, orderBy=[ca_country#1 ASC NULLS FIRST,ca_state#2 ASC NULLS FIRST,ca_county#3 ASC NULLS FIRST,i_item_id#4 ASC NULLS FIRST], output=[i_item_id#4,ca_country#1,ca_state#2,ca_county#3,agg1#5,agg2#6,agg3#7,agg4#8,agg5#9,agg6#10,agg7#11])
+- *(26) HashAggregate(keys=[i_item_id#4, ca_country#1, ca_state#2, ca_county#3, spark_grouping_id#12], functions=[avg(cast(cs_quantity#13 as decimal(12,2))), avg(cast(cs_list_price#14 as decimal(12,2))), avg(cast(cs_coupon_amt#15 as decimal(12,2))), avg(cast(cs_sales_price#16 as decimal(12,2))), avg(cast(cs_net_profit#17 as decimal(12,2))), avg(cast(c_birth_year#18 as decimal(12,2))), avg(cast(cd_dep_count#19 as decimal(12,2)))])
   +- Exchange hashpartitioning(i_item_id#4, ca_country#1, ca_state#2, ca_county#3, spark_grouping_id#12, 5)
      +- *(25) HashAggregate(keys=[i_item_id#4, ca_country#1, ca_state#2, ca_county#3, spark_grouping_id#12], functions=[partial_avg(cast(cs_quantity#13 as decimal(12,2))), partial_avg(cast(cs_list_price#14 as decimal(12,2))), partial_avg(cast(cs_coupon_amt#15 as decimal(12,2))), partial_avg(cast(cs_sales_price#16 as decimal(12,2))), partial_avg(cast(cs_net_profit#17 as decimal(12,2))), partial_avg(cast(c_birth_year#18 as decimal(12,2))), partial_avg(cast(cd_dep_count#19 as decimal(12,2)))])
         +- *(25) Expand [List(cs_quantity#13, cs_list_price#14, cs_sales_price#16, cs_coupon_amt#15, cs_net_profit#17, cd_dep_count#19, c_birth_year#18, i_item_id#20, ca_country#21, ca_state#22, ca_county#23, 0), List(cs_quantity#13, cs_list_price#14, cs_sales_price#16, cs_coupon_amt#15, cs_net_profit#17, cd_dep_count#19, c_birth_year#18, i_item_id#20, ca_country#21, ca_state#22, null, 1), List(cs_quantity#13, cs_list_price#14, cs_sales_price#16, cs_coupon_amt#15, cs_net_profit#17, cd_dep_count#19, c_birth_year#18, i_item_id#20, ca_country#21, null, null, 3), List(cs_quantity#13, cs_list_price#14, cs_sales_price#16, cs_coupon_amt#15, cs_net_profit#17, cd_dep_count#19, c_birth_year#18, i_item_id#20, null, null, null, 7), List(cs_quantity#13, cs_list_price#14, cs_sales_price#16, cs_coupon_amt#15, cs_net_profit#17, cd_dep_count#19, c_birth_year#18, null, null, null, null, 15)], [cs_quantity#13, cs_list_price#14, cs_sales_price#16, cs_coupon_amt#15, cs_net_profit#17, cd_dep_count#19, c_birth_year#18, i_item_id#4, ca_country#1, ca_state#2, ca_county#3, spark_grouping_id#12]
            +- *(25) Project [cs_quantity#13, cs_list_price#14, cs_sales_price#16, cs_coupon_amt#15, cs_net_profit#17, cd_dep_count#19, c_birth_year#18, i_item_id#24 AS i_item_id#20, ca_country#25 AS ca_country#21, ca_state#26 AS ca_state#22, ca_county#27 AS ca_county#23]
               +- *(25) SortMergeJoin [cs_item_sk#28], [i_item_sk#29], Inner
                  :- *(22) Sort [cs_item_sk#28 ASC NULLS FIRST], false, 0
                  :  +- Exchange hashpartitioning(cs_item_sk#28, 5)
                  :     +- *(21) Project [cs_item_sk#28, cs_quantity#13, cs_list_price#14, cs_sales_price#16, cs_coupon_amt#15, cs_net_profit#17, cd_dep_count#19, c_birth_year#18, ca_county#27, ca_state#26, ca_country#25]
                  :        +- *(21) SortMergeJoin [cs_sold_date_sk#30], [d_date_sk#31], Inner
                  :           :- *(18) Sort [cs_sold_date_sk#30 ASC NULLS FIRST], false, 0
                  :           :  +- Exchange hashpartitioning(cs_sold_date_sk#30, 5)
                  :           :     +- *(17) Project [cs_sold_date_sk#30, cs_item_sk#28, cs_quantity#13, cs_list_price#14, cs_sales_price#16, cs_coupon_amt#15, cs_net_profit#17, cd_dep_count#19, c_birth_year#18, ca_county#27, ca_state#26, ca_country#25]
                  :           :        +- *(17) SortMergeJoin [c_current_addr_sk#32], [ca_address_sk#33], Inner
                  :           :           :- *(14) Sort [c_current_addr_sk#32 ASC NULLS FIRST], false, 0
                  :           :           :  +- Exchange hashpartitioning(c_current_addr_sk#32, 5)
                  :           :           :     +- *(13) Project [cs_sold_date_sk#30, cs_item_sk#28, cs_quantity#13, cs_list_price#14, cs_sales_price#16, cs_coupon_amt#15, cs_net_profit#17, cd_dep_count#19, c_current_addr_sk#32, c_birth_year#18]
                  :           :           :        +- *(13) SortMergeJoin [c_current_cdemo_sk#34], [cd_demo_sk#35], Inner
                  :           :           :           :- *(10) Sort [c_current_cdemo_sk#34 ASC NULLS FIRST], false, 0
                  :           :           :           :  +- Exchange hashpartitioning(c_current_cdemo_sk#34, 5)
                  :           :           :           :     +- *(9) Project [cs_sold_date_sk#30, cs_item_sk#28, cs_quantity#13, cs_list_price#14, cs_sales_price#16, cs_coupon_amt#15, cs_net_profit#17, cd_dep_count#19, c_current_cdemo_sk#34, c_current_addr_sk#32, c_birth_year#18]
                  :           :           :           :        +- *(9) SortMergeJoin [cs_bill_customer_sk#36], [c_customer_sk#37], Inner
                  :           :           :           :           :- *(6) Sort [cs_bill_customer_sk#36 ASC NULLS FIRST], false, 0
                  :           :           :           :           :  +- Exchange hashpartitioning(cs_bill_customer_sk#36, 5)
                  :           :           :           :           :     +- *(5) Project [cs_sold_date_sk#30, cs_bill_customer_sk#36, cs_item_sk#28, cs_quantity#13, cs_list_price#14, cs_sales_price#16, cs_coupon_amt#15, cs_net_profit#17, cd_dep_count#19]
                  :           :           :           :           :        +- *(5) SortMergeJoin [cs_bill_cdemo_sk#38], [cd_demo_sk#39], Inner
                  :           :           :           :           :           :- *(2) Sort [cs_bill_cdemo_sk#38 ASC NULLS FIRST], false, 0
                  :           :           :           :           :           :  +- Exchange hashpartitioning(cs_bill_cdemo_sk#38, 5)
                  :           :           :           :           :           :     +- *(1) Project [cs_sold_date_sk#30, cs_bill_customer_sk#36, cs_bill_cdemo_sk#38, cs_item_sk#28, cs_quantity#13, cs_list_price#14, cs_sales_price#16, cs_coupon_amt#15, cs_net_profit#17]
                  :           :           :           :           :           :        +- *(1) Filter (((isnotnull(cs_bill_cdemo_sk#38) && isnotnull(cs_bill_customer_sk#36)) && isnotnull(cs_sold_date_sk#30)) && isnotnull(cs_item_sk#28))
                  :           :           :           :           :           :           +- *(1) FileScan Hyperspace(Type: CI, Name: JoinIndex26-index-6-cs_sold_date_sk-26, LogVersion: 0) default.catalog_sales[cs_sold_date_sk#30,cs_bill_customer_sk#36,cs_bill_cdemo_sk#38,cs_item_sk#28,cs_quantity#13,cs_list_price#14,cs_sales_price#16,cs_coupon_amt#15,cs_net_profit#17] Batched: true, Format: Parquet, Location: InMemoryFileIndex[], PartitionFilters: [], PushedFilters: [IsNotNull(cs_bill_cdemo_sk), IsNotNull(cs_bill_customer_sk), IsNotNull(cs_sold_date_sk), IsNotNu..., ReadSchema: struct<cs_sold_date_sk:int,cs_bill_customer_sk:int,cs_bill_cdemo_sk:int,cs_item_sk:int,cs_quantit...
                  :           :           :           :           :           +- *(4) Sort [cd_demo_sk#39 ASC NULLS FIRST], false, 0
                  :           :           :           :           :              +- Exchange hashpartitioning(cd_demo_sk#39, 5)
                  :           :           :           :           :                 +- *(3) Project [cd_demo_sk#39, cd_dep_count#19]
                  :           :           :           :           :                    +- *(3) Filter ((((isnotnull(cd_gender#40) && isnotnull(cd_education_status#41)) && (cd_gender#40 = F)) && (cd_education_status#41 = Unknown)) && isnotnull(cd_demo_sk#39))
                  :           :           :           :           :                       +- *(3) FileScan Hyperspace(Type: CI, Name: JoinIndex25-index-18-cd_demo_sk-8, LogVersion: 0) default.customer_demographics[cd_demo_sk#39,cd_gender#40,cd_education_status#41,cd_dep_count#19] Batched: true, Format: Parquet, Location: InMemoryFileIndex[], PartitionFilters: [], PushedFilters: [IsNotNull(cd_gender), IsNotNull(cd_education_status), EqualTo(cd_gender,F), EqualTo(cd_education..., ReadSchema: struct<cd_demo_sk:int,cd_gender:string,cd_education_status:string,cd_dep_count:int>
                  :           :           :           :           +- *(8) Sort [c_customer_sk#37 ASC NULLS FIRST], false, 0
                  :           :           :           :              +- Exchange hashpartitioning(c_customer_sk#37, 5)
                  :           :           :           :                 +- *(7) Project [c_customer_sk#37, c_current_cdemo_sk#34, c_current_addr_sk#32, c_birth_year#18]
                  :           :           :           :                    +- *(7) Filter (((c_birth_month#42 IN (1,6,8,9,12,2) && isnotnull(c_customer_sk#37)) && isnotnull(c_current_cdemo_sk#34)) && isnotnull(c_current_addr_sk#32))
                  :           :           :           :                       +- *(7) FileScan Hyperspace(Type: CI, Name: JoinIndex43-index-8-c_customer_sk-17, LogVersion: 0) default.customer[c_customer_sk#37,c_current_cdemo_sk#34,c_current_addr_sk#32,c_birth_month#42,c_birth_year#18] Batched: true, Format: Parquet, Location: InMemoryFileIndex[], PartitionFilters: [], PushedFilters: [In(c_birth_month, [1,6,8,9,12,2]), IsNotNull(c_customer_sk), IsNotNull(c_current_cdemo_sk), IsNo..., ReadSchema: struct<c_customer_sk:int,c_current_cdemo_sk:int,c_current_addr_sk:int,c_birth_month:int,c_birth_y...
                  :           :           :           +- *(12) Sort [cd_demo_sk#35 ASC NULLS FIRST], false, 0
                  :           :           :              +- Exchange hashpartitioning(cd_demo_sk#35, 5)
                  :           :           :                 +- *(11) Project [cd_demo_sk#35]
                  :           :           :                    +- *(11) Filter isnotnull(cd_demo_sk#35)
                  :           :           :                       +- *(11) FileScan Hyperspace(Type: CI, Name: JoinIndex25-index-18-cd_demo_sk-8, LogVersion: 0) default.customer_demographics[cd_demo_sk#35] Batched: true, Format: Parquet, Location: InMemoryFileIndex[], PartitionFilters: [], PushedFilters: [IsNotNull(cd_demo_sk)], ReadSchema: struct<cd_demo_sk:int>
                  :           :           +- *(16) Sort [ca_address_sk#33 ASC NULLS FIRST], false, 0
                  :           :              +- Exchange hashpartitioning(ca_address_sk#33, 5)
                  :           :                 +- *(15) Project [ca_address_sk#33, ca_county#27, ca_state#26, ca_country#25]
                  :           :                    +- *(15) Filter (ca_state#26 IN (MS,IN,ND,OK,NM,VA) && isnotnull(ca_address_sk#33))
                  :           :                       +- *(15) FileScan Hyperspace(Type: CI, Name: FilterIndex32-index-35-ca_state-11, LogVersion: 0) default.customer_address[ca_address_sk#33,ca_county#27,ca_state#26,ca_country#25] Batched: true, Format: Parquet, Location: InMemoryFileIndex[], PartitionFilters: [], PushedFilters: [In(ca_state, [MS,IN,ND,OK,NM,VA]), IsNotNull(ca_address_sk)], ReadSchema: struct<ca_address_sk:int,ca_county:string,ca_state:string,ca_country:string>
                  :           +- *(20) Sort [d_date_sk#31 ASC NULLS FIRST], false, 0
                  :              +- Exchange hashpartitioning(d_date_sk#31, 5)
                  :                 +- *(19) Project [d_date_sk#31]
                  :                    +- *(19) Filter ((isnotnull(d_year#43) && (d_year#43 = 1998)) && isnotnull(d_date_sk#31))
                  :                       +- *(19) FileScan Hyperspace(Type: CI, Name: FilterIndex04-index-11-d_year-5, LogVersion: 0) default.date_dim[d_date_sk#31,d_year#43] Batched: true, Format: Parquet, Location: InMemoryFileIndex[], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), EqualTo(d_year,1998), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
                  +- *(24) Sort [i_item_sk#29 ASC NULLS FIRST], false, 0
                     +- Exchange hashpartitioning(i_item_sk#29, 5)
                        +- *(23) Project [i_item_sk#29, i_item_id#24]
                           +- *(23) Filter isnotnull(i_item_sk#29)
                              +- *(23) FileScan Hyperspace(Type: CI, Name: FilterIndex09-index-32-i_item_sk-1, LogVersion: 0) default.item[i_item_sk#29,i_item_id#24] Batched: true, Format: Parquet, Location: InMemoryFileIndex[], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_item_id:string>