== Physical Plan ==
*(20) HashAggregate(keys=[], functions=[avg(cast(ss_quantity#1 as bigint)), avg(UnscaledValue(ss_ext_sales_price#2)), avg(UnscaledValue(ss_ext_wholesale_cost#3)), sum(UnscaledValue(ss_ext_wholesale_cost#3))])
+- Exchange SinglePartition
   +- *(19) HashAggregate(keys=[], functions=[partial_avg(cast(ss_quantity#1 as bigint)), partial_avg(UnscaledValue(ss_ext_sales_price#2)), partial_avg(UnscaledValue(ss_ext_wholesale_cost#3)), partial_sum(UnscaledValue(ss_ext_wholesale_cost#3))])
      +- *(19) Project [ss_quantity#1, ss_ext_sales_price#2, ss_ext_wholesale_cost#3]
         +- *(19) SortMergeJoin [ss_hdemo_sk#4], [hd_demo_sk#5], Inner, (((((((cd_marital_status#6 = M) && (cd_education_status#7 = Advanced Degree)) && (ss_sales_price#8 >= 100.00)) && (ss_sales_price#8 <= 150.00)) && (hd_dep_count#9 = 3)) || (((((cd_marital_status#6 = S) && (cd_education_status#7 = College)) && (ss_sales_price#8 >= 50.00)) && (ss_sales_price#8 <= 100.00)) && (hd_dep_count#9 = 1))) || (((((cd_marital_status#6 = W) && (cd_education_status#7 = 2 yr Degree)) && (ss_sales_price#8 >= 150.00)) && (ss_sales_price#8 <= 200.00)) && (hd_dep_count#9 = 1)))
            :- *(16) Sort [ss_hdemo_sk#4 ASC NULLS FIRST], false, 0
            :  +- Exchange hashpartitioning(ss_hdemo_sk#4, 5)
            :     +- *(15) Project [ss_hdemo_sk#4, ss_quantity#1, ss_sales_price#8, ss_ext_sales_price#2, ss_ext_wholesale_cost#3, cd_marital_status#6, cd_education_status#7]
            :        +- *(15) SortMergeJoin [ss_cdemo_sk#10], [cd_demo_sk#11], Inner
            :           :- *(12) Sort [ss_cdemo_sk#10 ASC NULLS FIRST], false, 0
            :           :  +- Exchange hashpartitioning(ss_cdemo_sk#10, 5)
            :           :     +- *(11) Project [ss_cdemo_sk#10, ss_hdemo_sk#4, ss_quantity#1, ss_sales_price#8, ss_ext_sales_price#2, ss_ext_wholesale_cost#3]
            :           :        +- *(11) SortMergeJoin [ss_sold_date_sk#12], [d_date_sk#13], Inner
            :           :           :- *(8) Sort [ss_sold_date_sk#12 ASC NULLS FIRST], false, 0
            :           :           :  +- Exchange hashpartitioning(ss_sold_date_sk#12, 5)
            :           :           :     +- *(7) Project [ss_sold_date_sk#12, ss_cdemo_sk#10, ss_hdemo_sk#4, ss_quantity#1, ss_sales_price#8, ss_ext_sales_price#2, ss_ext_wholesale_cost#3]
            :           :           :        +- *(7) SortMergeJoin [ss_addr_sk#14], [ca_address_sk#15], Inner, ((((ca_state#16 IN (TX,OH) && (ss_net_profit#17 >= 100.00)) && (ss_net_profit#17 <= 200.00)) || ((ca_state#16 IN (OR,NM,KY) && (ss_net_profit#17 >= 150.00)) && (ss_net_profit#17 <= 300.00))) || ((ca_state#16 IN (VA,TX,MS) && (ss_net_profit#17 >= 50.00)) && (ss_net_profit#17 <= 250.00)))
            :           :           :           :- *(4) Sort [ss_addr_sk#14 ASC NULLS FIRST], false, 0
            :           :           :           :  +- Exchange hashpartitioning(ss_addr_sk#14, 5)
            :           :           :           :     +- *(3) Project [ss_sold_date_sk#12, ss_cdemo_sk#10, ss_hdemo_sk#4, ss_addr_sk#14, ss_quantity#1, ss_sales_price#8, ss_ext_sales_price#2, ss_ext_wholesale_cost#3, ss_net_profit#17]
            :           :           :           :        +- *(3) SortMergeJoin [ss_store_sk#18], [s_store_sk#19], Inner
            :           :           :           :           :- *(1) Project [ss_sold_date_sk#12, ss_cdemo_sk#10, ss_hdemo_sk#4, ss_addr_sk#14, ss_store_sk#18, ss_quantity#1, ss_sales_price#8, ss_ext_sales_price#2, ss_ext_wholesale_cost#3, ss_net_profit#17]
            :           :           :           :           :  +- *(1) Filter ((((isnotnull(ss_store_sk#18) && isnotnull(ss_addr_sk#14)) && isnotnull(ss_sold_date_sk#12)) && isnotnull(ss_cdemo_sk#10)) && isnotnull(ss_hdemo_sk#4))
            :           :           :           :           :     +- *(1) FileScan Hyperspace(Type: CI, Name: JoinIndex14-index-5-ss_store_sk-20, LogVersion: 0) default.store_sales[ss_sold_date_sk#12,ss_cdemo_sk#10,ss_hdemo_sk#4,ss_addr_sk#14,ss_store_sk#18,ss_quantity#1,ss_sales_price#8,ss_ext_sales_price#2,ss_ext_wholesale_cost#3,ss_net_profit#17] Batched: true, Format: Parquet, Location: InMemoryFileIndex[], PartitionFilters: [], PushedFilters: [IsNotNull(ss_store_sk), IsNotNull(ss_addr_sk), IsNotNull(ss_sold_date_sk), IsNotNull(ss_cdemo_sk..., ReadSchema: struct<ss_sold_date_sk:int,ss_cdemo_sk:int,ss_hdemo_sk:int,ss_addr_sk:int,ss_store_sk:int,ss_quan..., SelectedBucketsCount: 200 out of 200
            :           :           :           :           +- *(2) Project [s_store_sk#19]
            :           :           :           :              +- *(2) Filter isnotnull(s_store_sk#19)
            :           :           :           :                 +- *(2) FileScan Hyperspace(Type: CI, Name: JoinIndex24-index-4-s_store_sk-15, LogVersion: 0) default.store[s_store_sk#19] Batched: true, Format: Parquet, Location: InMemoryFileIndex[], PartitionFilters: [], PushedFilters: [IsNotNull(s_store_sk)], ReadSchema: struct<s_store_sk:int>, SelectedBucketsCount: 200 out of 200
            :           :           :           +- *(6) Sort [ca_address_sk#15 ASC NULLS FIRST], false, 0
            :           :           :              +- Exchange hashpartitioning(ca_address_sk#15, 5)
            :           :           :                 +- *(5) Project [ca_address_sk#15, ca_state#16]
            :           :           :                    +- *(5) Filter ((isnotnull(ca_country#20) && (ca_country#20 = United States)) && isnotnull(ca_address_sk#15))
            :           :           :                       +- *(5) FileScan Hyperspace(Type: CI, Name: JoinIndex31-index-7-ca_address_sk-11, LogVersion: 0) default.customer_address[ca_address_sk#15,ca_state#16,ca_country#20] Batched: true, Format: Parquet, Location: InMemoryFileIndex[], PartitionFilters: [], PushedFilters: [IsNotNull(ca_country), EqualTo(ca_country,United States), IsNotNull(ca_address_sk)], ReadSchema: struct<ca_address_sk:int,ca_state:string,ca_country:string>
            :           :           +- *(10) Sort [d_date_sk#13 ASC NULLS FIRST], false, 0
            :           :              +- Exchange hashpartitioning(d_date_sk#13, 5)
            :           :                 +- *(9) Project [d_date_sk#13]
            :           :                    +- *(9) Filter ((isnotnull(d_year#21) && (d_year#21 = 2001)) && isnotnull(d_date_sk#13))
            :           :                       +- *(9) FileScan Hyperspace(Type: CI, Name: FilterIndex04-index-11-d_year-5, LogVersion: 0) default.date_dim[d_date_sk#13,d_year#21] Batched: true, Format: Parquet, Location: InMemoryFileIndex[], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), EqualTo(d_year,2001), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
            :           +- *(14) Sort [cd_demo_sk#11 ASC NULLS FIRST], false, 0
            :              +- Exchange hashpartitioning(cd_demo_sk#11, 5)
            :                 +- *(13) Project [cd_demo_sk#11, cd_marital_status#6, cd_education_status#7]
            :                    +- *(13) Filter isnotnull(cd_demo_sk#11)
            :                       +- *(13) FileScan Hyperspace(Type: CI, Name: JoinIndex25-index-18-cd_demo_sk-8, LogVersion: 0) default.customer_demographics[cd_demo_sk#11,cd_marital_status#6,cd_education_status#7] Batched: true, Format: Parquet, Location: InMemoryFileIndex[], PartitionFilters: [], PushedFilters: [IsNotNull(cd_demo_sk)], ReadSchema: struct<cd_demo_sk:int,cd_marital_status:string,cd_education_status:string>
            +- *(18) Sort [hd_demo_sk#5 ASC NULLS FIRST], false, 0
               +- Exchange hashpartitioning(hd_demo_sk#5, 5)
                  +- *(17) Project [hd_demo_sk#5, hd_dep_count#9]
                     +- *(17) Filter isnotnull(hd_demo_sk#5)
                        +- *(17) FileScan Hyperspace(Type: CI, Name: JoinIndex46-index-19-hd_demo_sk-4, LogVersion: 0) default.household_demographics[hd_demo_sk#5,hd_dep_count#9] Batched: true, Format: Parquet, Location: InMemoryFileIndex[], PartitionFilters: [], PushedFilters: [IsNotNull(hd_demo_sk)], ReadSchema: struct<hd_demo_sk:int,hd_dep_count:int>