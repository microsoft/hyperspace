== Physical Plan ==
*(27) Sort [Returns_Loss#1 DESC NULLS LAST], true, 0
+- Exchange rangepartitioning(Returns_Loss#1 DESC NULLS LAST, 5)
   +- *(26) HashAggregate(keys=[cc_call_center_id#2, cc_name#3, cc_manager#4, cd_marital_status#5, cd_education_status#6], functions=[sum(UnscaledValue(cr_net_loss#7))])
      +- Exchange hashpartitioning(cc_call_center_id#2, cc_name#3, cc_manager#4, cd_marital_status#5, cd_education_status#6, 5)
         +- *(25) HashAggregate(keys=[cc_call_center_id#2, cc_name#3, cc_manager#4, cd_marital_status#5, cd_education_status#6], functions=[partial_sum(UnscaledValue(cr_net_loss#7))])
            +- *(25) Project [cc_call_center_id#2, cc_name#3, cc_manager#4, cr_net_loss#7, cd_marital_status#5, cd_education_status#6]
               +- *(25) SortMergeJoin [c_current_hdemo_sk#8], [hd_demo_sk#9], Inner
                  :- *(22) Sort [c_current_hdemo_sk#8 ASC NULLS FIRST], false, 0
                  :  +- Exchange hashpartitioning(c_current_hdemo_sk#8, 5)
                  :     +- *(21) Project [cc_call_center_id#2, cc_name#3, cc_manager#4, cr_net_loss#7, c_current_hdemo_sk#8, cd_marital_status#5, cd_education_status#6]
                  :        +- *(21) SortMergeJoin [c_current_cdemo_sk#10], [cd_demo_sk#11], Inner
                  :           :- *(18) Sort [c_current_cdemo_sk#10 ASC NULLS FIRST], false, 0
                  :           :  +- Exchange hashpartitioning(c_current_cdemo_sk#10, 5)
                  :           :     +- *(17) Project [cc_call_center_id#2, cc_name#3, cc_manager#4, cr_net_loss#7, c_current_cdemo_sk#10, c_current_hdemo_sk#8]
                  :           :        +- *(17) SortMergeJoin [c_current_addr_sk#12], [ca_address_sk#13], Inner
                  :           :           :- *(14) Sort [c_current_addr_sk#12 ASC NULLS FIRST], false, 0
                  :           :           :  +- Exchange hashpartitioning(c_current_addr_sk#12, 5)
                  :           :           :     +- *(13) Project [cc_call_center_id#2, cc_name#3, cc_manager#4, cr_net_loss#7, c_current_cdemo_sk#10, c_current_hdemo_sk#8, c_current_addr_sk#12]
                  :           :           :        +- *(13) SortMergeJoin [cr_returning_customer_sk#14], [c_customer_sk#15], Inner
                  :           :           :           :- *(10) Sort [cr_returning_customer_sk#14 ASC NULLS FIRST], false, 0
                  :           :           :           :  +- Exchange hashpartitioning(cr_returning_customer_sk#14, 5)
                  :           :           :           :     +- *(9) Project [cc_call_center_id#2, cc_name#3, cc_manager#4, cr_returning_customer_sk#14, cr_net_loss#7]
                  :           :           :           :        +- *(9) SortMergeJoin [cr_returned_date_sk#16], [d_date_sk#17], Inner
                  :           :           :           :           :- *(6) Sort [cr_returned_date_sk#16 ASC NULLS FIRST], false, 0
                  :           :           :           :           :  +- Exchange hashpartitioning(cr_returned_date_sk#16, 5)
                  :           :           :           :           :     +- *(5) Project [cc_call_center_id#2, cc_name#3, cc_manager#4, cr_returned_date_sk#16, cr_returning_customer_sk#14, cr_net_loss#7]
                  :           :           :           :           :        +- *(5) SortMergeJoin [cc_call_center_sk#18], [cr_call_center_sk#19], Inner
                  :           :           :           :           :           :- *(2) Sort [cc_call_center_sk#18 ASC NULLS FIRST], false, 0
                  :           :           :           :           :           :  +- Exchange hashpartitioning(cc_call_center_sk#18, 5)
                  :           :           :           :           :           :     +- *(1) Project [cc_call_center_sk#18, cc_call_center_id#2, cc_name#3, cc_manager#4]
                  :           :           :           :           :           :        +- *(1) Filter isnotnull(cc_call_center_sk#18)
                  :           :           :           :           :           :           +- *(1) FileScan parquet default.call_center[cc_call_center_sk#18,cc_call_center_id#2,cc_name#3,cc_manager#4] Batched: true, Format: Parquet, Location [not included in comparison]/{warehouse_dir}/call_center], PartitionFilters: [], PushedFilters: [IsNotNull(cc_call_center_sk)], ReadSchema: struct<cc_call_center_sk:int,cc_call_center_id:string,cc_name:string,cc_manager:string>
                  :           :           :           :           :           +- *(4) Sort [cr_call_center_sk#19 ASC NULLS FIRST], false, 0
                  :           :           :           :           :              +- Exchange hashpartitioning(cr_call_center_sk#19, 5)
                  :           :           :           :           :                 +- *(3) Project [cr_returned_date_sk#16, cr_returning_customer_sk#14, cr_call_center_sk#19, cr_net_loss#7]
                  :           :           :           :           :                    +- *(3) Filter ((isnotnull(cr_call_center_sk#19) && isnotnull(cr_returned_date_sk#16)) && isnotnull(cr_returning_customer_sk#14))
                  :           :           :           :           :                       +- *(3) FileScan parquet default.catalog_returns[cr_returned_date_sk#16,cr_returning_customer_sk#14,cr_call_center_sk#19,cr_net_loss#7] Batched: true, Format: Parquet, Location [not included in comparison]/{warehouse_dir}/catalog_returns], PartitionFilters: [], PushedFilters: [IsNotNull(cr_call_center_sk), IsNotNull(cr_returned_date_sk), IsNotNull(cr_returning_customer_sk)], ReadSchema: struct<cr_returned_date_sk:int,cr_returning_customer_sk:int,cr_call_center_sk:int,cr_net_loss:dec...
                  :           :           :           :           +- *(8) Sort [d_date_sk#17 ASC NULLS FIRST], false, 0
                  :           :           :           :              +- Exchange hashpartitioning(d_date_sk#17, 5)
                  :           :           :           :                 +- *(7) Project [d_date_sk#17]
                  :           :           :           :                    +- *(7) Filter ((((isnotnull(d_year#20) && isnotnull(d_moy#21)) && (d_year#20 = 1998)) && (d_moy#21 = 11)) && isnotnull(d_date_sk#17))
                  :           :           :           :                       +- *(7) FileScan Hyperspace(Type: CI, Name: FilterIndex04-index-11-d_year-5, LogVersion: 0) default.date_dim[d_date_sk#17,d_year#20,d_moy#21] Batched: true, Format: Parquet, Location: InMemoryFileIndex[], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), IsNotNull(d_moy), EqualTo(d_year,1998), EqualTo(d_moy,11), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int,d_moy:int>
                  :           :           :           +- *(12) Sort [c_customer_sk#15 ASC NULLS FIRST], false, 0
                  :           :           :              +- Exchange hashpartitioning(c_customer_sk#15, 5)
                  :           :           :                 +- *(11) Project [c_customer_sk#15, c_current_cdemo_sk#10, c_current_hdemo_sk#8, c_current_addr_sk#12]
                  :           :           :                    +- *(11) Filter (((isnotnull(c_customer_sk#15) && isnotnull(c_current_addr_sk#12)) && isnotnull(c_current_cdemo_sk#10)) && isnotnull(c_current_hdemo_sk#8))
                  :           :           :                       +- *(11) FileScan Hyperspace(Type: CI, Name: JoinIndex43-index-8-c_customer_sk-17, LogVersion: 0) default.customer[c_customer_sk#15,c_current_cdemo_sk#10,c_current_hdemo_sk#8,c_current_addr_sk#12] Batched: true, Format: Parquet, Location: InMemoryFileIndex[], PartitionFilters: [], PushedFilters: [IsNotNull(c_customer_sk), IsNotNull(c_current_addr_sk), IsNotNull(c_current_cdemo_sk), IsNotNull..., ReadSchema: struct<c_customer_sk:int,c_current_cdemo_sk:int,c_current_hdemo_sk:int,c_current_addr_sk:int>
                  :           :           +- *(16) Sort [ca_address_sk#13 ASC NULLS FIRST], false, 0
                  :           :              +- Exchange hashpartitioning(ca_address_sk#13, 5)
                  :           :                 +- *(15) Project [ca_address_sk#13]
                  :           :                    +- *(15) Filter ((isnotnull(ca_gmt_offset#22) && (ca_gmt_offset#22 = -7.00)) && isnotnull(ca_address_sk#13))
                  :           :                       +- *(15) FileScan Hyperspace(Type: CI, Name: FilterIndex34-index-45-ca_gmt_offset-1, LogVersion: 0) default.customer_address[ca_address_sk#13,ca_gmt_offset#22] Batched: true, Format: Parquet, Location: InMemoryFileIndex[], PartitionFilters: [], PushedFilters: [IsNotNull(ca_gmt_offset), EqualTo(ca_gmt_offset,-7.00), IsNotNull(ca_address_sk)], ReadSchema: struct<ca_address_sk:int,ca_gmt_offset:decimal(5,2)>
                  :           +- *(20) Sort [cd_demo_sk#11 ASC NULLS FIRST], false, 0
                  :              +- Exchange hashpartitioning(cd_demo_sk#11, 5)
                  :                 +- *(19) Project [cd_demo_sk#11, cd_marital_status#5, cd_education_status#6]
                  :                    +- *(19) Filter ((((cd_marital_status#5 = M) && (cd_education_status#6 = Unknown)) || ((cd_marital_status#5 = W) && (cd_education_status#6 = Advanced Degree))) && isnotnull(cd_demo_sk#11))
                  :                       +- *(19) FileScan Hyperspace(Type: CI, Name: JoinIndex25-index-18-cd_demo_sk-8, LogVersion: 0) default.customer_demographics[cd_demo_sk#11,cd_marital_status#5,cd_education_status#6] Batched: true, Format: Parquet, Location: InMemoryFileIndex[], PartitionFilters: [], PushedFilters: [Or(And(EqualTo(cd_marital_status,M),EqualTo(cd_education_status,Unknown)),And(EqualTo(cd_marital..., ReadSchema: struct<cd_demo_sk:int,cd_marital_status:string,cd_education_status:string>
                  +- *(24) Sort [hd_demo_sk#9 ASC NULLS FIRST], false, 0
                     +- Exchange hashpartitioning(hd_demo_sk#9, 5)
                        +- *(23) Project [hd_demo_sk#9]
                           +- *(23) Filter ((isnotnull(hd_buy_potential#23) && StartsWith(hd_buy_potential#23, Unknown)) && isnotnull(hd_demo_sk#9))
                              +- *(23) FileScan Hyperspace(Type: CI, Name: JoinIndex46-index-19-hd_demo_sk-4, LogVersion: 0) default.household_demographics[hd_demo_sk#9,hd_buy_potential#23] Batched: true, Format: Parquet, Location: InMemoryFileIndex[], PartitionFilters: [], PushedFilters: [IsNotNull(hd_buy_potential), StringStartsWith(hd_buy_potential,Unknown), IsNotNull(hd_demo_sk)], ReadSchema: struct<hd_demo_sk:int,hd_buy_potential:string>