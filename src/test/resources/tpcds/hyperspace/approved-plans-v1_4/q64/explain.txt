== Physical Plan ==
*(150) Sort [product_name#1 ASC NULLS FIRST, store_name#2 ASC NULLS FIRST, cnt#3 ASC NULLS FIRST], true, 0
+- Exchange rangepartitioning(product_name#1 ASC NULLS FIRST, store_name#2 ASC NULLS FIRST, cnt#3 ASC NULLS FIRST, 200)
   +- *(149) Project [product_name#1, store_name#2, store_zip#4, b_street_number#5, b_streen_name#6, b_city#7, b_zip#8, c_street_number#9, c_street_name#10, c_city#11, c_zip#12, syear#13, cnt#14, s1#15, s2#16, s3#17, s1#18, s2#19, s3#20, syear#21, cnt#3]
      +- *(149) SortMergeJoin [item_sk#22, store_name#2, store_zip#4], [item_sk#23, store_name#24, store_zip#25], Inner, (cnt#3 <= cnt#14)
         :- *(74) Sort [item_sk#22 ASC NULLS FIRST, store_name#2 ASC NULLS FIRST, store_zip#4 ASC NULLS FIRST], false, 0
         :  +- Exchange hashpartitioning(item_sk#22, store_name#2, store_zip#4, 200)
         :     +- *(73) HashAggregate(keys=[i_product_name#26, i_item_sk#27, s_store_name#28, s_zip#29, ca_street_number#30, ca_street_name#31, ca_city#32, ca_zip#33, ca_street_number#34, ca_street_name#35, ca_city#36, ca_zip#37, d_year#38, d_year#39, d_year#40], functions=[count(1), sum(UnscaledValue(ss_wholesale_cost#41)), sum(UnscaledValue(ss_list_price#42)), sum(UnscaledValue(ss_coupon_amt#43))])
         :        +- *(73) HashAggregate(keys=[i_product_name#26, i_item_sk#27, s_store_name#28, s_zip#29, ca_street_number#30, ca_street_name#31, ca_city#32, ca_zip#33, ca_street_number#34, ca_street_name#35, ca_city#36, ca_zip#37, d_year#38, d_year#39, d_year#40], functions=[partial_count(1), partial_sum(UnscaledValue(ss_wholesale_cost#41)), partial_sum(UnscaledValue(ss_list_price#42)), partial_sum(UnscaledValue(ss_coupon_amt#43))])
         :           +- *(73) Project [ss_wholesale_cost#41, ss_list_price#42, ss_coupon_amt#43, d_year#38, d_year#39, d_year#40, s_store_name#28, s_zip#29, ca_street_number#30, ca_street_name#31, ca_city#32, ca_zip#33, ca_street_number#34, ca_street_name#35, ca_city#36, ca_zip#37, i_item_sk#27, i_product_name#26]
         :              +- *(73) SortMergeJoin [ss_item_sk#44], [i_item_sk#27], Inner
         :                 :- *(70) Sort [ss_item_sk#44 ASC NULLS FIRST], false, 0
         :                 :  +- Exchange hashpartitioning(ss_item_sk#44, 200)
         :                 :     +- *(69) Project [ss_item_sk#44, ss_wholesale_cost#41, ss_list_price#42, ss_coupon_amt#43, d_year#38, s_store_name#28, s_zip#29, d_year#39, d_year#40, ca_street_number#30, ca_street_name#31, ca_city#32, ca_zip#33, ca_street_number#34, ca_street_name#35, ca_city#36, ca_zip#37]
         :                 :        +- *(69) SortMergeJoin [hd_income_band_sk#45], [ib_income_band_sk#46], Inner
         :                 :           :- *(66) Sort [hd_income_band_sk#45 ASC NULLS FIRST], false, 0
         :                 :           :  +- Exchange hashpartitioning(hd_income_band_sk#45, 200)
         :                 :           :     +- *(65) Project [ss_item_sk#44, ss_wholesale_cost#41, ss_list_price#42, ss_coupon_amt#43, d_year#38, s_store_name#28, s_zip#29, d_year#39, d_year#40, hd_income_band_sk#45, ca_street_number#30, ca_street_name#31, ca_city#32, ca_zip#33, ca_street_number#34, ca_street_name#35, ca_city#36, ca_zip#37]
         :                 :           :        +- *(65) SortMergeJoin [hd_income_band_sk#47], [ib_income_band_sk#48], Inner
         :                 :           :           :- *(62) Sort [hd_income_band_sk#47 ASC NULLS FIRST], false, 0
         :                 :           :           :  +- Exchange hashpartitioning(hd_income_band_sk#47, 200)
         :                 :           :           :     +- *(61) Project [ss_item_sk#44, ss_wholesale_cost#41, ss_list_price#42, ss_coupon_amt#43, d_year#38, s_store_name#28, s_zip#29, d_year#39, d_year#40, hd_income_band_sk#47, hd_income_band_sk#45, ca_street_number#30, ca_street_name#31, ca_city#32, ca_zip#33, ca_street_number#34, ca_street_name#35, ca_city#36, ca_zip#37]
         :                 :           :           :        +- *(61) SortMergeJoin [c_current_addr_sk#49], [ca_address_sk#50], Inner
         :                 :           :           :           :- *(58) Sort [c_current_addr_sk#49 ASC NULLS FIRST], false, 0
         :                 :           :           :           :  +- Exchange hashpartitioning(c_current_addr_sk#49, 200)
         :                 :           :           :           :     +- *(57) Project [ss_item_sk#44, ss_wholesale_cost#41, ss_list_price#42, ss_coupon_amt#43, d_year#38, s_store_name#28, s_zip#29, c_current_addr_sk#49, d_year#39, d_year#40, hd_income_band_sk#47, hd_income_band_sk#45, ca_street_number#30, ca_street_name#31, ca_city#32, ca_zip#33]
         :                 :           :           :           :        +- *(57) SortMergeJoin [ss_addr_sk#51], [ca_address_sk#52], Inner
         :                 :           :           :           :           :- *(54) Sort [ss_addr_sk#51 ASC NULLS FIRST], false, 0
         :                 :           :           :           :           :  +- Exchange hashpartitioning(ss_addr_sk#51, 200)
         :                 :           :           :           :           :     +- *(53) Project [ss_item_sk#44, ss_addr_sk#51, ss_wholesale_cost#41, ss_list_price#42, ss_coupon_amt#43, d_year#38, s_store_name#28, s_zip#29, c_current_addr_sk#49, d_year#39, d_year#40, hd_income_band_sk#47, hd_income_band_sk#45]
         :                 :           :           :           :           :        +- *(53) SortMergeJoin [c_current_hdemo_sk#53], [hd_demo_sk#54], Inner
         :                 :           :           :           :           :           :- *(50) Sort [c_current_hdemo_sk#53 ASC NULLS FIRST], false, 0
         :                 :           :           :           :           :           :  +- Exchange hashpartitioning(c_current_hdemo_sk#53, 200)
         :                 :           :           :           :           :           :     +- *(49) Project [ss_item_sk#44, ss_addr_sk#51, ss_wholesale_cost#41, ss_list_price#42, ss_coupon_amt#43, d_year#38, s_store_name#28, s_zip#29, c_current_hdemo_sk#53, c_current_addr_sk#49, d_year#39, d_year#40, hd_income_band_sk#47]
         :                 :           :           :           :           :           :        +- *(49) SortMergeJoin [ss_hdemo_sk#55], [hd_demo_sk#56], Inner
         :                 :           :           :           :           :           :           :- *(46) Sort [ss_hdemo_sk#55 ASC NULLS FIRST], false, 0
         :                 :           :           :           :           :           :           :  +- Exchange hashpartitioning(ss_hdemo_sk#55, 200)
         :                 :           :           :           :           :           :           :     +- *(45) Project [ss_item_sk#44, ss_hdemo_sk#55, ss_addr_sk#51, ss_wholesale_cost#41, ss_list_price#42, ss_coupon_amt#43, d_year#38, s_store_name#28, s_zip#29, c_current_hdemo_sk#53, c_current_addr_sk#49, d_year#39, d_year#40]
         :                 :           :           :           :           :           :           :        +- *(45) SortMergeJoin [ss_promo_sk#57], [p_promo_sk#58], Inner
         :                 :           :           :           :           :           :           :           :- *(42) Sort [ss_promo_sk#57 ASC NULLS FIRST], false, 0
         :                 :           :           :           :           :           :           :           :  +- Exchange hashpartitioning(ss_promo_sk#57, 200)
         :                 :           :           :           :           :           :           :           :     +- *(41) Project [ss_item_sk#44, ss_hdemo_sk#55, ss_addr_sk#51, ss_promo_sk#57, ss_wholesale_cost#41, ss_list_price#42, ss_coupon_amt#43, d_year#38, s_store_name#28, s_zip#29, c_current_hdemo_sk#53, c_current_addr_sk#49, d_year#39, d_year#40]
         :                 :           :           :           :           :           :           :           :        +- *(41) SortMergeJoin [c_current_cdemo_sk#59], [cd_demo_sk#60], Inner, NOT (cd_marital_status#61 = cd_marital_status#62)
         :                 :           :           :           :           :           :           :           :           :- *(38) Sort [c_current_cdemo_sk#59 ASC NULLS FIRST], false, 0
         :                 :           :           :           :           :           :           :           :           :  +- Exchange hashpartitioning(c_current_cdemo_sk#59, 200)
         :                 :           :           :           :           :           :           :           :           :     +- *(37) Project [ss_item_sk#44, ss_hdemo_sk#55, ss_addr_sk#51, ss_promo_sk#57, ss_wholesale_cost#41, ss_list_price#42, ss_coupon_amt#43, d_year#38, s_store_name#28, s_zip#29, c_current_cdemo_sk#59, c_current_hdemo_sk#53, c_current_addr_sk#49, d_year#39, d_year#40, cd_marital_status#61]
         :                 :           :           :           :           :           :           :           :           :        +- *(37) SortMergeJoin [ss_cdemo_sk#63], [cd_demo_sk#64], Inner
         :                 :           :           :           :           :           :           :           :           :           :- *(34) Sort [ss_cdemo_sk#63 ASC NULLS FIRST], false, 0
         :                 :           :           :           :           :           :           :           :           :           :  +- Exchange hashpartitioning(ss_cdemo_sk#63, 200)
         :                 :           :           :           :           :           :           :           :           :           :     +- *(33) Project [ss_item_sk#44, ss_cdemo_sk#63, ss_hdemo_sk#55, ss_addr_sk#51, ss_promo_sk#57, ss_wholesale_cost#41, ss_list_price#42, ss_coupon_amt#43, d_year#38, s_store_name#28, s_zip#29, c_current_cdemo_sk#59, c_current_hdemo_sk#53, c_current_addr_sk#49, d_year#39, d_year#40]
         :                 :           :           :           :           :           :           :           :           :           :        +- *(33) SortMergeJoin [c_first_shipto_date_sk#65], [d_date_sk#66], Inner
         :                 :           :           :           :           :           :           :           :           :           :           :- *(30) Sort [c_first_shipto_date_sk#65 ASC NULLS FIRST], false, 0
         :                 :           :           :           :           :           :           :           :           :           :           :  +- Exchange hashpartitioning(c_first_shipto_date_sk#65, 200)
         :                 :           :           :           :           :           :           :           :           :           :           :     +- *(29) Project [ss_item_sk#44, ss_cdemo_sk#63, ss_hdemo_sk#55, ss_addr_sk#51, ss_promo_sk#57, ss_wholesale_cost#41, ss_list_price#42, ss_coupon_amt#43, d_year#38, s_store_name#28, s_zip#29, c_current_cdemo_sk#59, c_current_hdemo_sk#53, c_current_addr_sk#49, c_first_shipto_date_sk#65, d_year#39]
         :                 :           :           :           :           :           :           :           :           :           :           :        +- *(29) SortMergeJoin [c_first_sales_date_sk#67], [d_date_sk#68], Inner
         :                 :           :           :           :           :           :           :           :           :           :           :           :- *(26) Sort [c_first_sales_date_sk#67 ASC NULLS FIRST], false, 0
         :                 :           :           :           :           :           :           :           :           :           :           :           :  +- Exchange hashpartitioning(c_first_sales_date_sk#67, 200)
         :                 :           :           :           :           :           :           :           :           :           :           :           :     +- *(25) Project [ss_item_sk#44, ss_cdemo_sk#63, ss_hdemo_sk#55, ss_addr_sk#51, ss_promo_sk#57, ss_wholesale_cost#41, ss_list_price#42, ss_coupon_amt#43, d_year#38, s_store_name#28, s_zip#29, c_current_cdemo_sk#59, c_current_hdemo_sk#53, c_current_addr_sk#49, c_first_shipto_date_sk#65, c_first_sales_date_sk#67]
         :                 :           :           :           :           :           :           :           :           :           :           :           :        +- *(25) SortMergeJoin [ss_customer_sk#69], [c_customer_sk#70], Inner
         :                 :           :           :           :           :           :           :           :           :           :           :           :           :- *(22) Sort [ss_customer_sk#69 ASC NULLS FIRST], false, 0
         :                 :           :           :           :           :           :           :           :           :           :           :           :           :  +- Exchange hashpartitioning(ss_customer_sk#69, 200)
         :                 :           :           :           :           :           :           :           :           :           :           :           :           :     +- *(21) Project [ss_item_sk#44, ss_customer_sk#69, ss_cdemo_sk#63, ss_hdemo_sk#55, ss_addr_sk#51, ss_promo_sk#57, ss_wholesale_cost#41, ss_list_price#42, ss_coupon_amt#43, d_year#38, s_store_name#28, s_zip#29]
         :                 :           :           :           :           :           :           :           :           :           :           :           :           :        +- *(21) SortMergeJoin [ss_store_sk#71], [s_store_sk#72], Inner
         :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :- *(18) Sort [ss_store_sk#71 ASC NULLS FIRST], false, 0
         :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :  +- Exchange hashpartitioning(ss_store_sk#71, 200)
         :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :     +- *(17) Project [ss_item_sk#44, ss_customer_sk#69, ss_cdemo_sk#63, ss_hdemo_sk#55, ss_addr_sk#51, ss_store_sk#71, ss_promo_sk#57, ss_wholesale_cost#41, ss_list_price#42, ss_coupon_amt#43, d_year#38]
         :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :        +- *(17) SortMergeJoin [ss_sold_date_sk#73], [d_date_sk#74], Inner
         :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :- *(14) Sort [ss_sold_date_sk#73 ASC NULLS FIRST], false, 0
         :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :  +- Exchange hashpartitioning(ss_sold_date_sk#73, 200)
         :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :     +- *(13) Project [ss_sold_date_sk#73, ss_item_sk#44, ss_customer_sk#69, ss_cdemo_sk#63, ss_hdemo_sk#55, ss_addr_sk#51, ss_store_sk#71, ss_promo_sk#57, ss_wholesale_cost#41, ss_list_price#42, ss_coupon_amt#43]
         :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :        +- *(13) SortMergeJoin [ss_item_sk#44], [cs_item_sk#75], Inner
         :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :- *(6) Sort [ss_item_sk#44 ASC NULLS FIRST], false, 0
         :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :  +- Exchange hashpartitioning(ss_item_sk#44, 200)
         :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :     +- *(5) Project [ss_sold_date_sk#73, ss_item_sk#44, ss_customer_sk#69, ss_cdemo_sk#63, ss_hdemo_sk#55, ss_addr_sk#51, ss_store_sk#71, ss_promo_sk#57, ss_wholesale_cost#41, ss_list_price#42, ss_coupon_amt#43]
         :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :        +- *(5) SortMergeJoin [cast(ss_item_sk#44 as bigint), cast(ss_ticket_number#76 as bigint)], [sr_item_sk#77, sr_ticket_number#78], Inner
         :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :- *(2) Sort [cast(ss_item_sk#44 as bigint) ASC NULLS FIRST, cast(ss_ticket_number#76 as bigint) ASC NULLS FIRST], false, 0
         :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :  +- Exchange hashpartitioning(cast(ss_item_sk#44 as bigint), cast(ss_ticket_number#76 as bigint), 200)
         :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :     +- *(1) Project [ss_sold_date_sk#73, ss_item_sk#44, ss_customer_sk#69, ss_cdemo_sk#63, ss_hdemo_sk#55, ss_addr_sk#51, ss_store_sk#71, ss_promo_sk#57, ss_ticket_number#76, ss_wholesale_cost#41, ss_list_price#42, ss_coupon_amt#43]
         :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :        +- *(1) Filter ((((((((isnotnull(ss_item_sk#44) && isnotnull(ss_ticket_number#76)) && isnotnull(ss_sold_date_sk#73)) && isnotnull(ss_store_sk#71)) && isnotnull(ss_customer_sk#69)) && isnotnull(ss_cdemo_sk#63)) && isnotnull(ss_promo_sk#57)) && isnotnull(ss_hdemo_sk#55)) && isnotnull(ss_addr_sk#51))
         :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           +- *(1) FileScan Hyperspace(Type: CI, Name: JoinIndex12-index-1-ss_sold_date_sk-21, LogVersion: 0) default.store_sales[ss_sold_date_sk#73,ss_item_sk#44,ss_customer_sk#69,ss_cdemo_sk#63,ss_hdemo_sk#55,ss_addr_sk#51,ss_store_sk#71,ss_promo_sk#57,ss_ticket_number#76,ss_wholesale_cost#41,ss_list_price#42,ss_coupon_amt#43] Batched: true, Format: Parquet, Location: InMemoryFileIndex[], PartitionFilters: [], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_ticket_number), IsNotNull(ss_sold_date_sk), IsNotNull(ss_sto..., ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int,ss_customer_sk:int,ss_cdemo_sk:int,ss_hdemo_sk:int,ss_a...
         :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           +- *(4) Sort [sr_item_sk#77 ASC NULLS FIRST, sr_ticket_number#78 ASC NULLS FIRST], false, 0
         :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :              +- Exchange hashpartitioning(sr_item_sk#77, sr_ticket_number#78, 200)
         :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                 +- *(3) Project [sr_item_sk#77, sr_ticket_number#78]
         :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                    +- *(3) Filter (isnotnull(sr_item_sk#77) && isnotnull(sr_ticket_number#78))
         :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                       +- *(3) FileScan Hyperspace(Type: CI, Name: JoinIndex21-index-20-sr_item_sk-7, LogVersion: 0) default.store_returns[sr_item_sk#77,sr_ticket_number#78] Batched: true, Format: Parquet, Location: InMemoryFileIndex[], PartitionFilters: [], PushedFilters: [IsNotNull(sr_item_sk), IsNotNull(sr_ticket_number)], ReadSchema: struct<sr_item_sk:bigint,sr_ticket_number:bigint>
         :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           +- *(12) Sort [cs_item_sk#75 ASC NULLS FIRST], false, 0
         :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :              +- *(12) Project [cs_item_sk#75]
         :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                 +- *(12) Filter (isnotnull(sum(cs_ext_list_price#79)#80) && (cast(sum(cs_ext_list_price#79)#80 as decimal(21,2)) > CheckOverflow((2.00 * promote_precision(sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#81 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#82 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#83 as decimal(9,2)))), DecimalType(9,2)))#84)), DecimalType(21,2))))
         :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                    +- *(12) HashAggregate(keys=[cs_item_sk#75], functions=[sum(UnscaledValue(cs_ext_list_price#79)), sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#81 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#82 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#83 as decimal(9,2)))), DecimalType(9,2)))])
         :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                       +- Exchange hashpartitioning(cs_item_sk#75, 200)
         :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                          +- *(11) HashAggregate(keys=[cs_item_sk#75], functions=[partial_sum(UnscaledValue(cs_ext_list_price#79)), partial_sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#81 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#82 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#83 as decimal(9,2)))), DecimalType(9,2)))])
         :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                             +- *(11) Project [cs_item_sk#75, cs_ext_list_price#79, cr_refunded_cash#81, cr_reversed_charge#82, cr_store_credit#83]
         :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                                +- *(11) SortMergeJoin [cs_item_sk#75, cs_order_number#85], [cr_item_sk#86, cr_order_number#87], Inner
         :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                                   :- *(8) Sort [cs_item_sk#75 ASC NULLS FIRST, cs_order_number#85 ASC NULLS FIRST], false, 0
         :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                                   :  +- Exchange hashpartitioning(cs_item_sk#75, cs_order_number#85, 200)
         :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                                   :     +- *(7) Project [cs_item_sk#75, cs_order_number#85, cs_ext_list_price#79]
         :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                                   :        +- *(7) Filter (isnotnull(cs_item_sk#75) && isnotnull(cs_order_number#85))
         :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                                   :           +- *(7) FileScan Hyperspace(Type: CI, Name: JoinIndex27-index-10-cs_item_sk-22, LogVersion: 0) default.catalog_sales[cs_item_sk#75,cs_order_number#85,cs_ext_list_price#79] Batched: true, Format: Parquet, Location: InMemoryFileIndex[], PartitionFilters: [], PushedFilters: [IsNotNull(cs_item_sk), IsNotNull(cs_order_number)], ReadSchema: struct<cs_item_sk:int,cs_order_number:int,cs_ext_list_price:decimal(7,2)>
         :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                                   +- *(10) Sort [cr_item_sk#86 ASC NULLS FIRST, cr_order_number#87 ASC NULLS FIRST], false, 0
         :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                                      +- Exchange hashpartitioning(cr_item_sk#86, cr_order_number#87, 200)
         :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                                         +- *(9) Project [cr_item_sk#86, cr_order_number#87, cr_refunded_cash#81, cr_reversed_charge#82, cr_store_credit#83]
         :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                                            +- *(9) Filter (isnotnull(cr_item_sk#86) && isnotnull(cr_order_number#87))
         :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                                               +- *(9) FileScan Hyperspace(Type: CI, Name: JoinIndex47-index-26-cr_item_sk-8, LogVersion: 0) default.catalog_returns[cr_item_sk#86,cr_order_number#87,cr_refunded_cash#81,cr_reversed_charge#82,cr_store_credit#83] Batched: true, Format: Parquet, Location: InMemoryFileIndex[], PartitionFilters: [], PushedFilters: [IsNotNull(cr_item_sk), IsNotNull(cr_order_number)], ReadSchema: struct<cr_item_sk:int,cr_order_number:int,cr_refunded_cash:decimal(7,2),cr_reversed_charge:decima...
         :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           +- *(16) Sort [d_date_sk#74 ASC NULLS FIRST], false, 0
         :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :              +- Exchange hashpartitioning(d_date_sk#74, 200)
         :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :                 +- *(15) Project [d_date_sk#74, d_year#38]
         :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :                    +- *(15) Filter ((isnotnull(d_year#38) && (d_year#38 = 1999)) && isnotnull(d_date_sk#74))
         :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :                       +- *(15) FileScan Hyperspace(Type: CI, Name: dtindex, LogVersion: 0) default.date_dim[d_date_sk#74,d_year#38] Batched: true, Format: Parquet, Location: InMemoryFileIndex[], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), EqualTo(d_year,1999), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
         :                 :           :           :           :           :           :           :           :           :           :           :           :           :           +- *(20) Sort [s_store_sk#72 ASC NULLS FIRST], false, 0
         :                 :           :           :           :           :           :           :           :           :           :           :           :           :              +- Exchange hashpartitioning(s_store_sk#72, 200)
         :                 :           :           :           :           :           :           :           :           :           :           :           :           :                 +- *(19) Project [s_store_sk#72, s_store_name#28, s_zip#29]
         :                 :           :           :           :           :           :           :           :           :           :           :           :           :                    +- *(19) Filter ((isnotnull(s_store_sk#72) && isnotnull(s_store_name#28)) && isnotnull(s_zip#29))
         :                 :           :           :           :           :           :           :           :           :           :           :           :           :                       +- *(19) FileScan Hyperspace(Type: CI, Name: JoinIndex24-index-4-s_store_sk-15, LogVersion: 0) default.store[s_store_sk#72,s_store_name#28,s_zip#29] Batched: true, Format: Parquet, Location: InMemoryFileIndex[], PartitionFilters: [], PushedFilters: [IsNotNull(s_store_sk), IsNotNull(s_store_name), IsNotNull(s_zip)], ReadSchema: struct<s_store_sk:int,s_store_name:string,s_zip:string>
         :                 :           :           :           :           :           :           :           :           :           :           :           :           +- *(24) Sort [c_customer_sk#70 ASC NULLS FIRST], false, 0
         :                 :           :           :           :           :           :           :           :           :           :           :           :              +- Exchange hashpartitioning(c_customer_sk#70, 200)
         :                 :           :           :           :           :           :           :           :           :           :           :           :                 +- *(23) Project [c_customer_sk#70, c_current_cdemo_sk#59, c_current_hdemo_sk#53, c_current_addr_sk#49, c_first_shipto_date_sk#65, c_first_sales_date_sk#67]
         :                 :           :           :           :           :           :           :           :           :           :           :           :                    +- *(23) Filter (((((isnotnull(c_customer_sk#70) && isnotnull(c_first_sales_date_sk#67)) && isnotnull(c_first_shipto_date_sk#65)) && isnotnull(c_current_cdemo_sk#59)) && isnotnull(c_current_hdemo_sk#53)) && isnotnull(c_current_addr_sk#49))
         :                 :           :           :           :           :           :           :           :           :           :           :           :                       +- *(23) FileScan Hyperspace(Type: CI, Name: JoinIndex43-index-8-c_customer_sk-17, LogVersion: 0) default.customer[c_customer_sk#70,c_current_cdemo_sk#59,c_current_hdemo_sk#53,c_current_addr_sk#49,c_first_shipto_date_sk#65,c_first_sales_date_sk#67] Batched: true, Format: Parquet, Location: InMemoryFileIndex[], PartitionFilters: [], PushedFilters: [IsNotNull(c_customer_sk), IsNotNull(c_first_sales_date_sk), IsNotNull(c_first_shipto_date_sk), I..., ReadSchema: struct<c_customer_sk:int,c_current_cdemo_sk:int,c_current_hdemo_sk:int,c_current_addr_sk:int,c_fi...
         :                 :           :           :           :           :           :           :           :           :           :           :           +- *(28) Sort [d_date_sk#68 ASC NULLS FIRST], false, 0
         :                 :           :           :           :           :           :           :           :           :           :           :              +- Exchange hashpartitioning(d_date_sk#68, 200)
         :                 :           :           :           :           :           :           :           :           :           :           :                 +- *(27) Project [d_date_sk#68, d_year#39]
         :                 :           :           :           :           :           :           :           :           :           :           :                    +- *(27) Filter isnotnull(d_date_sk#68)
         :                 :           :           :           :           :           :           :           :           :           :           :                       +- *(27) FileScan Hyperspace(Type: CI, Name: dtindex, LogVersion: 0) default.date_dim[d_date_sk#68,d_year#39] Batched: true, Format: Parquet, Location: InMemoryFileIndex[], PartitionFilters: [], PushedFilters: [IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
         :                 :           :           :           :           :           :           :           :           :           :           +- *(32) Sort [d_date_sk#66 ASC NULLS FIRST], false, 0
         :                 :           :           :           :           :           :           :           :           :           :              +- ReusedExchange [d_date_sk#66, d_year#40], Exchange hashpartitioning(d_date_sk#68, 200)
         :                 :           :           :           :           :           :           :           :           :           +- *(36) Sort [cd_demo_sk#64 ASC NULLS FIRST], false, 0
         :                 :           :           :           :           :           :           :           :           :              +- Exchange hashpartitioning(cd_demo_sk#64, 200)
         :                 :           :           :           :           :           :           :           :           :                 +- *(35) Project [cd_demo_sk#64, cd_marital_status#61]
         :                 :           :           :           :           :           :           :           :           :                    +- *(35) Filter (isnotnull(cd_demo_sk#64) && isnotnull(cd_marital_status#61))
         :                 :           :           :           :           :           :           :           :           :                       +- *(35) FileScan Hyperspace(Type: CI, Name: JoinIndex25-index-18-cd_demo_sk-8, LogVersion: 0) default.customer_demographics[cd_demo_sk#64,cd_marital_status#61] Batched: true, Format: Parquet, Location: InMemoryFileIndex[], PartitionFilters: [], PushedFilters: [IsNotNull(cd_demo_sk), IsNotNull(cd_marital_status)], ReadSchema: struct<cd_demo_sk:int,cd_marital_status:string>
         :                 :           :           :           :           :           :           :           :           +- *(40) Sort [cd_demo_sk#60 ASC NULLS FIRST], false, 0
         :                 :           :           :           :           :           :           :           :              +- ReusedExchange [cd_demo_sk#60, cd_marital_status#62], Exchange hashpartitioning(cd_demo_sk#64, 200)
         :                 :           :           :           :           :           :           :           +- *(44) Sort [p_promo_sk#58 ASC NULLS FIRST], false, 0
         :                 :           :           :           :           :           :           :              +- Exchange hashpartitioning(p_promo_sk#58, 200)
         :                 :           :           :           :           :           :           :                 +- *(43) Project [p_promo_sk#58]
         :                 :           :           :           :           :           :           :                    +- *(43) Filter isnotnull(p_promo_sk#58)
         :                 :           :           :           :           :           :           :                       +- *(43) FileScan Hyperspace(Type: CI, Name: JoinIndex49-index-40-p_promo_sk-4, LogVersion: 0) default.promotion[p_promo_sk#58] Batched: true, Format: Parquet, Location: InMemoryFileIndex[], PartitionFilters: [], PushedFilters: [IsNotNull(p_promo_sk)], ReadSchema: struct<p_promo_sk:int>
         :                 :           :           :           :           :           :           +- *(48) Sort [hd_demo_sk#56 ASC NULLS FIRST], false, 0
         :                 :           :           :           :           :           :              +- Exchange hashpartitioning(hd_demo_sk#56, 200)
         :                 :           :           :           :           :           :                 +- *(47) Project [hd_demo_sk#56, hd_income_band_sk#47]
         :                 :           :           :           :           :           :                    +- *(47) Filter (isnotnull(hd_demo_sk#56) && isnotnull(hd_income_band_sk#47))
         :                 :           :           :           :           :           :                       +- *(47) FileScan Hyperspace(Type: CI, Name: JoinIndex46-index-19-hd_demo_sk-4, LogVersion: 0) default.household_demographics[hd_demo_sk#56,hd_income_band_sk#47] Batched: true, Format: Parquet, Location: InMemoryFileIndex[], PartitionFilters: [], PushedFilters: [IsNotNull(hd_demo_sk), IsNotNull(hd_income_band_sk)], ReadSchema: struct<hd_demo_sk:int,hd_income_band_sk:int>
         :                 :           :           :           :           :           +- *(52) Sort [hd_demo_sk#54 ASC NULLS FIRST], false, 0
         :                 :           :           :           :           :              +- ReusedExchange [hd_demo_sk#54, hd_income_band_sk#45], Exchange hashpartitioning(hd_demo_sk#56, 200)
         :                 :           :           :           :           +- *(56) Sort [ca_address_sk#52 ASC NULLS FIRST], false, 0
         :                 :           :           :           :              +- Exchange hashpartitioning(ca_address_sk#52, 200)
         :                 :           :           :           :                 +- *(55) Project [ca_address_sk#52, ca_street_number#30, ca_street_name#31, ca_city#32, ca_zip#33]
         :                 :           :           :           :                    +- *(55) Filter isnotnull(ca_address_sk#52)
         :                 :           :           :           :                       +- *(55) FileScan Hyperspace(Type: CI, Name: JoinIndex31-index-7-ca_address_sk-11, LogVersion: 0) default.customer_address[ca_address_sk#52,ca_street_number#30,ca_street_name#31,ca_city#32,ca_zip#33] Batched: true, Format: Parquet, Location: InMemoryFileIndex[], PartitionFilters: [], PushedFilters: [IsNotNull(ca_address_sk)], ReadSchema: struct<ca_address_sk:int,ca_street_number:string,ca_street_name:string,ca_city:string,ca_zip:string>
         :                 :           :           :           +- *(60) Sort [ca_address_sk#50 ASC NULLS FIRST], false, 0
         :                 :           :           :              +- ReusedExchange [ca_address_sk#50, ca_street_number#34, ca_street_name#35, ca_city#36, ca_zip#37], Exchange hashpartitioning(ca_address_sk#52, 200)
         :                 :           :           +- *(64) Sort [ib_income_band_sk#48 ASC NULLS FIRST], false, 0
         :                 :           :              +- Exchange hashpartitioning(ib_income_band_sk#48, 200)
         :                 :           :                 +- *(63) Project [ib_income_band_sk#48]
         :                 :           :                    +- *(63) Filter isnotnull(ib_income_band_sk#48)
         :                 :           :                       +- *(63) FileScan parquet default.income_band[ib_income_band_sk#48] Batched: true, Format: Parquet, Location [not included in comparison]/{warehouse_dir}/income_band], PartitionFilters: [], PushedFilters: [IsNotNull(ib_income_band_sk)], ReadSchema: struct<ib_income_band_sk:int>
         :                 :           +- *(68) Sort [ib_income_band_sk#46 ASC NULLS FIRST], false, 0
         :                 :              +- ReusedExchange [ib_income_band_sk#46], Exchange hashpartitioning(ib_income_band_sk#48, 200)
         :                 +- *(72) Sort [i_item_sk#27 ASC NULLS FIRST], false, 0
         :                    +- Exchange hashpartitioning(i_item_sk#27, 200)
         :                       +- *(71) Project [i_item_sk#27, i_product_name#26]
         :                          +- *(71) Filter ((((((isnotnull(i_current_price#88) && i_color#89 IN (purple,burlywood,indian,spring,floral,medium)) && (i_current_price#88 >= 64.00)) && (cast(i_current_price#88 as decimal(12,2)) <= 74.00)) && (cast(i_current_price#88 as decimal(12,2)) >= 65.00)) && (cast(i_current_price#88 as decimal(12,2)) <= 79.00)) && isnotnull(i_item_sk#27))
         :                             +- *(71) FileScan Hyperspace(Type: CI, Name: JoinIndex08-index-2-i_item_sk-17, LogVersion: 0) default.item[i_item_sk#27,i_current_price#88,i_color#89,i_product_name#26] Batched: true, Format: Parquet, Location: InMemoryFileIndex[], PartitionFilters: [], PushedFilters: [IsNotNull(i_current_price), In(i_color, [purple,burlywood,indian,spring,floral,medium]), Greater..., ReadSchema: struct<i_item_sk:int,i_current_price:decimal(7,2),i_color:string,i_product_name:string>
         +- *(148) Sort [item_sk#23 ASC NULLS FIRST, store_name#24 ASC NULLS FIRST, store_zip#25 ASC NULLS FIRST], false, 0
            +- Exchange hashpartitioning(item_sk#23, store_name#24, store_zip#25, 200)
               +- *(147) HashAggregate(keys=[i_product_name#26, i_item_sk#27, s_store_name#28, s_zip#29, ca_street_number#30, ca_street_name#31, ca_city#32, ca_zip#33, ca_street_number#34, ca_street_name#35, ca_city#36, ca_zip#37, d_year#38, d_year#39, d_year#40], functions=[count(1), sum(UnscaledValue(ss_wholesale_cost#41)), sum(UnscaledValue(ss_list_price#42)), sum(UnscaledValue(ss_coupon_amt#43))])
                  +- *(147) HashAggregate(keys=[i_product_name#26, i_item_sk#27, s_store_name#28, s_zip#29, ca_street_number#30, ca_street_name#31, ca_city#32, ca_zip#33, ca_street_number#34, ca_street_name#35, ca_city#36, ca_zip#37, d_year#38, d_year#39, d_year#40], functions=[partial_count(1), partial_sum(UnscaledValue(ss_wholesale_cost#41)), partial_sum(UnscaledValue(ss_list_price#42)), partial_sum(UnscaledValue(ss_coupon_amt#43))])
                     +- *(147) Project [ss_wholesale_cost#41, ss_list_price#42, ss_coupon_amt#43, d_year#38, d_year#39, d_year#40, s_store_name#28, s_zip#29, ca_street_number#30, ca_street_name#31, ca_city#32, ca_zip#33, ca_street_number#34, ca_street_name#35, ca_city#36, ca_zip#37, i_item_sk#27, i_product_name#26]
                        +- *(147) SortMergeJoin [ss_item_sk#44], [i_item_sk#27], Inner
                           :- *(144) Sort [ss_item_sk#44 ASC NULLS FIRST], false, 0
                           :  +- Exchange hashpartitioning(ss_item_sk#44, 200)
                           :     +- *(143) Project [ss_item_sk#44, ss_wholesale_cost#41, ss_list_price#42, ss_coupon_amt#43, d_year#38, s_store_name#28, s_zip#29, d_year#39, d_year#40, ca_street_number#30, ca_street_name#31, ca_city#32, ca_zip#33, ca_street_number#34, ca_street_name#35, ca_city#36, ca_zip#37]
                           :        +- *(143) SortMergeJoin [hd_income_band_sk#45], [ib_income_band_sk#46], Inner
                           :           :- *(140) Sort [hd_income_band_sk#45 ASC NULLS FIRST], false, 0
                           :           :  +- Exchange hashpartitioning(hd_income_band_sk#45, 200)
                           :           :     +- *(139) Project [ss_item_sk#44, ss_wholesale_cost#41, ss_list_price#42, ss_coupon_amt#43, d_year#38, s_store_name#28, s_zip#29, d_year#39, d_year#40, hd_income_band_sk#45, ca_street_number#30, ca_street_name#31, ca_city#32, ca_zip#33, ca_street_number#34, ca_street_name#35, ca_city#36, ca_zip#37]
                           :           :        +- *(139) SortMergeJoin [hd_income_band_sk#47], [ib_income_band_sk#48], Inner
                           :           :           :- *(136) Sort [hd_income_band_sk#47 ASC NULLS FIRST], false, 0
                           :           :           :  +- Exchange hashpartitioning(hd_income_band_sk#47, 200)
                           :           :           :     +- *(135) Project [ss_item_sk#44, ss_wholesale_cost#41, ss_list_price#42, ss_coupon_amt#43, d_year#38, s_store_name#28, s_zip#29, d_year#39, d_year#40, hd_income_band_sk#47, hd_income_band_sk#45, ca_street_number#30, ca_street_name#31, ca_city#32, ca_zip#33, ca_street_number#34, ca_street_name#35, ca_city#36, ca_zip#37]
                           :           :           :        +- *(135) SortMergeJoin [c_current_addr_sk#49], [ca_address_sk#50], Inner
                           :           :           :           :- *(132) Sort [c_current_addr_sk#49 ASC NULLS FIRST], false, 0
                           :           :           :           :  +- Exchange hashpartitioning(c_current_addr_sk#49, 200)
                           :           :           :           :     +- *(131) Project [ss_item_sk#44, ss_wholesale_cost#41, ss_list_price#42, ss_coupon_amt#43, d_year#38, s_store_name#28, s_zip#29, c_current_addr_sk#49, d_year#39, d_year#40, hd_income_band_sk#47, hd_income_band_sk#45, ca_street_number#30, ca_street_name#31, ca_city#32, ca_zip#33]
                           :           :           :           :        +- *(131) SortMergeJoin [ss_addr_sk#51], [ca_address_sk#52], Inner
                           :           :           :           :           :- *(128) Sort [ss_addr_sk#51 ASC NULLS FIRST], false, 0
                           :           :           :           :           :  +- Exchange hashpartitioning(ss_addr_sk#51, 200)
                           :           :           :           :           :     +- *(127) Project [ss_item_sk#44, ss_addr_sk#51, ss_wholesale_cost#41, ss_list_price#42, ss_coupon_amt#43, d_year#38, s_store_name#28, s_zip#29, c_current_addr_sk#49, d_year#39, d_year#40, hd_income_band_sk#47, hd_income_band_sk#45]
                           :           :           :           :           :        +- *(127) SortMergeJoin [c_current_hdemo_sk#53], [hd_demo_sk#54], Inner
                           :           :           :           :           :           :- *(124) Sort [c_current_hdemo_sk#53 ASC NULLS FIRST], false, 0
                           :           :           :           :           :           :  +- Exchange hashpartitioning(c_current_hdemo_sk#53, 200)
                           :           :           :           :           :           :     +- *(123) Project [ss_item_sk#44, ss_addr_sk#51, ss_wholesale_cost#41, ss_list_price#42, ss_coupon_amt#43, d_year#38, s_store_name#28, s_zip#29, c_current_hdemo_sk#53, c_current_addr_sk#49, d_year#39, d_year#40, hd_income_band_sk#47]
                           :           :           :           :           :           :        +- *(123) SortMergeJoin [ss_hdemo_sk#55], [hd_demo_sk#56], Inner
                           :           :           :           :           :           :           :- *(120) Sort [ss_hdemo_sk#55 ASC NULLS FIRST], false, 0
                           :           :           :           :           :           :           :  +- Exchange hashpartitioning(ss_hdemo_sk#55, 200)
                           :           :           :           :           :           :           :     +- *(119) Project [ss_item_sk#44, ss_hdemo_sk#55, ss_addr_sk#51, ss_wholesale_cost#41, ss_list_price#42, ss_coupon_amt#43, d_year#38, s_store_name#28, s_zip#29, c_current_hdemo_sk#53, c_current_addr_sk#49, d_year#39, d_year#40]
                           :           :           :           :           :           :           :        +- *(119) SortMergeJoin [ss_promo_sk#57], [p_promo_sk#58], Inner
                           :           :           :           :           :           :           :           :- *(116) Sort [ss_promo_sk#57 ASC NULLS FIRST], false, 0
                           :           :           :           :           :           :           :           :  +- Exchange hashpartitioning(ss_promo_sk#57, 200)
                           :           :           :           :           :           :           :           :     +- *(115) Project [ss_item_sk#44, ss_hdemo_sk#55, ss_addr_sk#51, ss_promo_sk#57, ss_wholesale_cost#41, ss_list_price#42, ss_coupon_amt#43, d_year#38, s_store_name#28, s_zip#29, c_current_hdemo_sk#53, c_current_addr_sk#49, d_year#39, d_year#40]
                           :           :           :           :           :           :           :           :        +- *(115) SortMergeJoin [c_current_cdemo_sk#59], [cd_demo_sk#60], Inner, NOT (cd_marital_status#61 = cd_marital_status#62)
                           :           :           :           :           :           :           :           :           :- *(112) Sort [c_current_cdemo_sk#59 ASC NULLS FIRST], false, 0
                           :           :           :           :           :           :           :           :           :  +- Exchange hashpartitioning(c_current_cdemo_sk#59, 200)
                           :           :           :           :           :           :           :           :           :     +- *(111) Project [ss_item_sk#44, ss_hdemo_sk#55, ss_addr_sk#51, ss_promo_sk#57, ss_wholesale_cost#41, ss_list_price#42, ss_coupon_amt#43, d_year#38, s_store_name#28, s_zip#29, c_current_cdemo_sk#59, c_current_hdemo_sk#53, c_current_addr_sk#49, d_year#39, d_year#40, cd_marital_status#61]
                           :           :           :           :           :           :           :           :           :        +- *(111) SortMergeJoin [ss_cdemo_sk#63], [cd_demo_sk#64], Inner
                           :           :           :           :           :           :           :           :           :           :- *(108) Sort [ss_cdemo_sk#63 ASC NULLS FIRST], false, 0
                           :           :           :           :           :           :           :           :           :           :  +- Exchange hashpartitioning(ss_cdemo_sk#63, 200)
                           :           :           :           :           :           :           :           :           :           :     +- *(107) Project [ss_item_sk#44, ss_cdemo_sk#63, ss_hdemo_sk#55, ss_addr_sk#51, ss_promo_sk#57, ss_wholesale_cost#41, ss_list_price#42, ss_coupon_amt#43, d_year#38, s_store_name#28, s_zip#29, c_current_cdemo_sk#59, c_current_hdemo_sk#53, c_current_addr_sk#49, d_year#39, d_year#40]
                           :           :           :           :           :           :           :           :           :           :        +- *(107) SortMergeJoin [c_first_shipto_date_sk#65], [d_date_sk#66], Inner
                           :           :           :           :           :           :           :           :           :           :           :- *(104) Sort [c_first_shipto_date_sk#65 ASC NULLS FIRST], false, 0
                           :           :           :           :           :           :           :           :           :           :           :  +- Exchange hashpartitioning(c_first_shipto_date_sk#65, 200)
                           :           :           :           :           :           :           :           :           :           :           :     +- *(103) Project [ss_item_sk#44, ss_cdemo_sk#63, ss_hdemo_sk#55, ss_addr_sk#51, ss_promo_sk#57, ss_wholesale_cost#41, ss_list_price#42, ss_coupon_amt#43, d_year#38, s_store_name#28, s_zip#29, c_current_cdemo_sk#59, c_current_hdemo_sk#53, c_current_addr_sk#49, c_first_shipto_date_sk#65, d_year#39]
                           :           :           :           :           :           :           :           :           :           :           :        +- *(103) SortMergeJoin [c_first_sales_date_sk#67], [d_date_sk#68], Inner
                           :           :           :           :           :           :           :           :           :           :           :           :- *(100) Sort [c_first_sales_date_sk#67 ASC NULLS FIRST], false, 0
                           :           :           :           :           :           :           :           :           :           :           :           :  +- Exchange hashpartitioning(c_first_sales_date_sk#67, 200)
                           :           :           :           :           :           :           :           :           :           :           :           :     +- *(99) Project [ss_item_sk#44, ss_cdemo_sk#63, ss_hdemo_sk#55, ss_addr_sk#51, ss_promo_sk#57, ss_wholesale_cost#41, ss_list_price#42, ss_coupon_amt#43, d_year#38, s_store_name#28, s_zip#29, c_current_cdemo_sk#59, c_current_hdemo_sk#53, c_current_addr_sk#49, c_first_shipto_date_sk#65, c_first_sales_date_sk#67]
                           :           :           :           :           :           :           :           :           :           :           :           :        +- *(99) SortMergeJoin [ss_customer_sk#69], [c_customer_sk#70], Inner
                           :           :           :           :           :           :           :           :           :           :           :           :           :- *(96) Sort [ss_customer_sk#69 ASC NULLS FIRST], false, 0
                           :           :           :           :           :           :           :           :           :           :           :           :           :  +- Exchange hashpartitioning(ss_customer_sk#69, 200)
                           :           :           :           :           :           :           :           :           :           :           :           :           :     +- *(95) Project [ss_item_sk#44, ss_customer_sk#69, ss_cdemo_sk#63, ss_hdemo_sk#55, ss_addr_sk#51, ss_promo_sk#57, ss_wholesale_cost#41, ss_list_price#42, ss_coupon_amt#43, d_year#38, s_store_name#28, s_zip#29]
                           :           :           :           :           :           :           :           :           :           :           :           :           :        +- *(95) SortMergeJoin [ss_store_sk#71], [s_store_sk#72], Inner
                           :           :           :           :           :           :           :           :           :           :           :           :           :           :- *(92) Sort [ss_store_sk#71 ASC NULLS FIRST], false, 0
                           :           :           :           :           :           :           :           :           :           :           :           :           :           :  +- Exchange hashpartitioning(ss_store_sk#71, 200)
                           :           :           :           :           :           :           :           :           :           :           :           :           :           :     +- *(91) Project [ss_item_sk#44, ss_customer_sk#69, ss_cdemo_sk#63, ss_hdemo_sk#55, ss_addr_sk#51, ss_store_sk#71, ss_promo_sk#57, ss_wholesale_cost#41, ss_list_price#42, ss_coupon_amt#43, d_year#38]
                           :           :           :           :           :           :           :           :           :           :           :           :           :           :        +- *(91) SortMergeJoin [ss_sold_date_sk#73], [d_date_sk#74], Inner
                           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :- *(88) Sort [ss_sold_date_sk#73 ASC NULLS FIRST], false, 0
                           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :  +- ReusedExchange [ss_sold_date_sk#73, ss_item_sk#44, ss_customer_sk#69, ss_cdemo_sk#63, ss_hdemo_sk#55, ss_addr_sk#51, ss_store_sk#71, ss_promo_sk#57, ss_wholesale_cost#41, ss_list_price#42, ss_coupon_amt#43], Exchange hashpartitioning(ss_sold_date_sk#73, 200)
                           :           :           :           :           :           :           :           :           :           :           :           :           :           :           +- *(90) Sort [d_date_sk#74 ASC NULLS FIRST], false, 0
                           :           :           :           :           :           :           :           :           :           :           :           :           :           :              +- Exchange hashpartitioning(d_date_sk#74, 200)
                           :           :           :           :           :           :           :           :           :           :           :           :           :           :                 +- *(89) Project [d_date_sk#74, d_year#38]
                           :           :           :           :           :           :           :           :           :           :           :           :           :           :                    +- *(89) Filter ((isnotnull(d_year#38) && (d_year#38 = 2000)) && isnotnull(d_date_sk#74))
                           :           :           :           :           :           :           :           :           :           :           :           :           :           :                       +- *(89) FileScan Hyperspace(Type: CI, Name: dtindex, LogVersion: 0) default.date_dim[d_date_sk#74,d_year#38] Batched: true, Format: Parquet, Location: InMemoryFileIndex[], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), EqualTo(d_year,2000), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
                           :           :           :           :           :           :           :           :           :           :           :           :           :           +- *(94) Sort [s_store_sk#72 ASC NULLS FIRST], false, 0
                           :           :           :           :           :           :           :           :           :           :           :           :           :              +- ReusedExchange [s_store_sk#72, s_store_name#28, s_zip#29], Exchange hashpartitioning(s_store_sk#72, 200)
                           :           :           :           :           :           :           :           :           :           :           :           :           +- *(98) Sort [c_customer_sk#70 ASC NULLS FIRST], false, 0
                           :           :           :           :           :           :           :           :           :           :           :           :              +- ReusedExchange [c_customer_sk#70, c_current_cdemo_sk#59, c_current_hdemo_sk#53, c_current_addr_sk#49, c_first_shipto_date_sk#65, c_first_sales_date_sk#67], Exchange hashpartitioning(c_customer_sk#70, 200)
                           :           :           :           :           :           :           :           :           :           :           :           +- *(102) Sort [d_date_sk#68 ASC NULLS FIRST], false, 0
                           :           :           :           :           :           :           :           :           :           :           :              +- ReusedExchange [d_date_sk#68, d_year#39], Exchange hashpartitioning(d_date_sk#68, 200)
                           :           :           :           :           :           :           :           :           :           :           +- *(106) Sort [d_date_sk#66 ASC NULLS FIRST], false, 0
                           :           :           :           :           :           :           :           :           :           :              +- ReusedExchange [d_date_sk#66, d_year#40], Exchange hashpartitioning(d_date_sk#68, 200)
                           :           :           :           :           :           :           :           :           :           +- *(110) Sort [cd_demo_sk#64 ASC NULLS FIRST], false, 0
                           :           :           :           :           :           :           :           :           :              +- ReusedExchange [cd_demo_sk#64, cd_marital_status#61], Exchange hashpartitioning(cd_demo_sk#64, 200)
                           :           :           :           :           :           :           :           :           +- *(114) Sort [cd_demo_sk#60 ASC NULLS FIRST], false, 0
                           :           :           :           :           :           :           :           :              +- ReusedExchange [cd_demo_sk#60, cd_marital_status#62], Exchange hashpartitioning(cd_demo_sk#64, 200)
                           :           :           :           :           :           :           :           +- *(118) Sort [p_promo_sk#58 ASC NULLS FIRST], false, 0
                           :           :           :           :           :           :           :              +- ReusedExchange [p_promo_sk#58], Exchange hashpartitioning(p_promo_sk#58, 200)
                           :           :           :           :           :           :           +- *(122) Sort [hd_demo_sk#56 ASC NULLS FIRST], false, 0
                           :           :           :           :           :           :              +- ReusedExchange [hd_demo_sk#56, hd_income_band_sk#47], Exchange hashpartitioning(hd_demo_sk#56, 200)
                           :           :           :           :           :           +- *(126) Sort [hd_demo_sk#54 ASC NULLS FIRST], false, 0
                           :           :           :           :           :              +- ReusedExchange [hd_demo_sk#54, hd_income_band_sk#45], Exchange hashpartitioning(hd_demo_sk#56, 200)
                           :           :           :           :           +- *(130) Sort [ca_address_sk#52 ASC NULLS FIRST], false, 0
                           :           :           :           :              +- ReusedExchange [ca_address_sk#52, ca_street_number#30, ca_street_name#31, ca_city#32, ca_zip#33], Exchange hashpartitioning(ca_address_sk#52, 200)
                           :           :           :           +- *(134) Sort [ca_address_sk#50 ASC NULLS FIRST], false, 0
                           :           :           :              +- ReusedExchange [ca_address_sk#50, ca_street_number#34, ca_street_name#35, ca_city#36, ca_zip#37], Exchange hashpartitioning(ca_address_sk#52, 200)
                           :           :           +- *(138) Sort [ib_income_band_sk#48 ASC NULLS FIRST], false, 0
                           :           :              +- ReusedExchange [ib_income_band_sk#48], Exchange hashpartitioning(ib_income_band_sk#48, 200)
                           :           +- *(142) Sort [ib_income_band_sk#46 ASC NULLS FIRST], false, 0
                           :              +- ReusedExchange [ib_income_band_sk#46], Exchange hashpartitioning(ib_income_band_sk#48, 200)
                           +- *(146) Sort [i_item_sk#27 ASC NULLS FIRST], false, 0
                              +- ReusedExchange [i_item_sk#27, i_product_name#26], Exchange hashpartitioning(i_item_sk#27, 200)